<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes, maximum-scale=1" />
<title>Carta</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root {
  /* Variables */
  --bg-light: #F9FAFB;
  --bg-dark: #0D0D0D;
  
  --card-light: #FFFFFF;
  --card-dark: #1C1C1E;
  
  --text-light: #1F2937;
  --text-dark: #F3F4F6;
  
  --muted-light: #6B7280;
  --muted-dark: #9CA3AF;
  
  --accent: #68B553; 
  --radius: 14px; /* Radio un poco m√°s peque√±o para ser m√°s compacto */
  --font: 'Plus Jakarta Sans', sans-serif;
  
  --shadow-sm: 0 1px 3px rgba(0,0,0,0.05);
  --shadow-float: 0 20px 40px -10px rgba(104, 181, 83, 0.3);
}

[data-theme="dark"] {
  --bg: var(--bg-dark);
  --card: var(--card-dark);
  --text: var(--text-dark);
  --muted: var(--muted-dark);
  --border: rgba(255,255,255,0.08);
  --glass: rgba(28, 28, 30, 0.85);
  --btn-bg: rgba(255,255,255,0.1);
  --input-bg: #2C2C2E;
}

[data-theme="light"] {
  --bg: var(--bg-light);
  --card: var(--card-light);
  --text: var(--text-light);
  --muted: var(--muted-light);
  --border: rgba(0,0,0,0.06);
  --glass: rgba(255, 255, 255, 0.85);
  --btn-bg: #f3f4f6;
  --input-bg: #F3F4F6;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: var(--font);
  transition: background 0.3s ease, color 0.3s ease;
  padding-bottom: 120px;
}

/* --- Header --- */
.header {
  position: sticky; top: 0; z-index: 100;
  background: var(--glass); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
  padding: 12px 20px; display: flex; justify-content: space-between; align-items: center;
  border-bottom: 1px solid var(--border);
}
.brand { font-size: 1.3rem; font-weight: 800; letter-spacing: -0.5px; }
.controls { display: flex; align-items: center; gap: 10px; }
.lang-display { font-size: 0.85rem; font-weight: 700; text-transform: uppercase; color: var(--muted); border: 1px solid var(--border); padding: 4px 8px; border-radius: 8px; }
.theme-toggle { background: none; border: none; cursor: pointer; padding: 4px; color: var(--text); display: flex; }

/* --- Filtros --- */
.filters-wrap {
  position: sticky; top: 65px; z-index: 90;
  background: var(--bg); padding: 10px 0; margin-bottom: 5px;
}
.filters-scroll {
  display: flex; gap: 8px; overflow-x: auto; padding: 0 20px; scrollbar-width: none;
}
.filters-scroll::-webkit-scrollbar { display: none; }
.filter-chip {
  padding: 6px 16px; background: var(--card); border: 1px solid var(--border);
  border-radius: 50px; white-space: nowrap; font-size: 0.9rem; font-weight: 600;
  color: var(--muted); cursor: pointer; transition: all 0.2s;
}
.filter-chip.active {
  background: var(--text); color: var(--bg); border-color: var(--text);
}

/* --- Grid Compacto (Estilo Lista) --- */
.menu-grid {
  display: grid;
  grid-template-columns: 1fr; /* Una columna por defecto para m√≥viles (lista) */
  gap: 12px; /* Menos espacio entre platos */
  padding: 0 20px;
  max-width: 800px;
  margin: 0 auto;
}

/* En pantallas grandes, 2 columnas */
@media(min-width: 600px) { .menu-grid { grid-template-columns: 1fr 1fr; } }

.product-card {
  background: var(--card); border-radius: var(--radius);
  padding: 14px; /* Padding reducido */
  border: 1px solid var(--border);
  display: flex; align-items: center; justify-content: space-between;
  gap: 12px;
}

.card-info { flex: 1; }

.product-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px; }
.product-name { font-weight: 700; font-size: 1rem; color: var(--text); line-height: 1.2; }
.product-desc { font-size: 0.85rem; color: var(--muted); line-height: 1.3; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

.card-actions {
  display: flex; flex-direction: column; align-items: flex-end; justify-content: center; gap: 4px;
}
.product-price { font-weight: 700; font-size: 1rem; color: var(--text); }

.add-btn {
  background: var(--btn-bg); color: var(--text); border: none;
  height: 36px; padding: 0 14px; border-radius: 10px;
  font-size: 1rem; font-weight: 600; cursor: pointer;
  transition: 0.2s; min-width: 40px;
}
.add-btn.has-items { background: var(--accent); color: white; }

/* --- Bot√≥n Flotante --- */
#cart-float {
  position: fixed; bottom: 20px; left: 50%;
  transform: translateX(-50%) scale(0.9) translateY(100px);
  background: var(--text); color: var(--bg);
  padding: 14px 24px; border-radius: 50px;
  display: flex; align-items: center; gap: 12px;
  box-shadow: var(--shadow-float); cursor: pointer; z-index: 1000;
  transition: 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); font-weight: 600;
}
#cart-float.visible { transform: translateX(-50%) scale(1) translateY(0); }
.badge-count { background: var(--accent); color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.85rem; }

/* --- Bottom Sheet --- */
.overlay {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.6); backdrop-filter: blur(4px);
  z-index: 2000; opacity: 0; pointer-events: none; transition: 0.3s;
  display: flex; justify-content: center; align-items: flex-end;
}
.overlay.open { opacity: 1; pointer-events: auto; }

.sheet {
  background: var(--card); width: 100%; max-width: 600px; max-height: 90vh;
  border-radius: 24px 24px 0 0; padding: 24px; display: flex; flex-direction: column;
  transform: translateY(100%); transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
.overlay.open .sheet { transform: translateY(0); }

.sheet-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid var(--border); padding-bottom: 15px; }
.order-items { overflow-y: auto; flex: 1; display: flex; flex-direction: column; gap: 10px; margin-bottom: 20px; }

.order-row { display: flex; justify-content: space-between; align-items: center; padding: 10px; background: var(--bg); border-radius: 12px; }
.qty-wrap { display: flex; align-items: center; gap: 10px; }
.q-btn { width: 28px; height: 28px; border-radius: 50%; border: none; background: var(--card); color: var(--text); font-weight: bold; box-shadow: var(--shadow-sm); cursor: pointer; }

/* Secci√≥n Total y Notas en el Modal */
.total-section {
  border-top: 1px solid var(--border);
  padding-top: 16px;
}
.total-row {
  display: flex; justify-content: space-between; align-items: center;
  font-size: 1.4rem; font-weight: 800; margin-bottom: 16px;
}
.total-val { color: var(--accent); }

textarea.order-notes {
  width: 100%; padding: 12px; border-radius: 12px;
  background: var(--input-bg); border: 1px solid var(--border);
  color: var(--text); font-family: inherit; resize: none;
  margin-bottom: 12px; font-size: 0.9rem;
}

.waiter-note {
  font-size: 0.85rem; color: var(--muted); text-align: center; margin-bottom: 10px;
}
</style>
</head>
<body>

<header class="header">
  <div class="brand">Carta</div>
  <div class="controls">
    <div class="lang-display" id="langDisplay">ES</div>
    <button class="theme-toggle" id="themeBtn"></button>
  </div>
</header>

<div class="filters-wrap">
  <div class="filters-scroll">
    <div class="filter-chip active" onclick="filter('all')" id="f-all">Todos</div>
    <div class="filter-chip" onclick="filter('entrantes')" id="f-ent">Entrantes</div>
    <div class="filter-chip" onclick="filter('principales')" id="f-main">Principales</div>
    <div class="filter-chip" onclick="filter('postres')" id="f-des">Postres</div>
    <div class="filter-chip" onclick="filter('bebidas')" id="f-drk">Bebidas</div>
  </div>
</div>

<div class="menu-grid" id="menuContainer"></div>

<div id="cart-float" onclick="openSheet()">
  <span class="badge-count" id="countBadge">0</span>
  <span id="btnText">Ver Pedido</span>
  <span id="totalPriceFloat" style="margin-left:auto; opacity:0.8">0.00‚Ç¨</span>
</div>

<div class="overlay" id="overlay" onclick="if(event.target===this) closeSheet()">
  <div class="sheet">
    <div class="sheet-header">
      <h3 style="margin:0; font-size:1.3rem" id="modalTitle">Tu Pedido</h3>
      <div onclick="closeSheet()" style="cursor:pointer; padding:5px; font-weight:bold">‚úï</div>
    </div>
    
    <div class="order-items" id="orderList"></div>

    <div class="total-section">
      <div class="total-row">
        <span>Total</span>
        <span class="total-val" id="sheetTotal">0.00‚Ç¨</span>
      </div>
      
      <textarea class="order-notes" id="notesField" placeholder="Notas (ej. sin cebolla, bebida con hielo...)" oninput="saveNotes()"></textarea>
      
      <div class="waiter-note" id="waiterMsg">üí° Lee esto al camarero.</div>
      
      <button onclick="clearCart()" style="width:100%; background:transparent; border:none; color:var(--muted); font-size:0.9rem; text-decoration:underline; cursor:pointer;">
        <span id="clearTxt">Borrar lista</span>
      </button>
    </div>
  </div>
</div>

<script>
/* --- TRADUCCIONES --- */
const i18n = {
  es: {
    all: "Todos", ent: "Entrantes", main: "Principales", des: "Postres", drk: "Bebidas",
    btn: "Ver Pedido", title: "Tu Pedido",
    msg: "üí° Lee esta lista al camarero/a.",
    clear: "Borrar todo", empty: "Lista vac√≠a",
    notesPlaceholder: "Notas (ej. sin cebolla, bebida con hielo...)"
  },
  en: {
    all: "All", ent: "Starters", main: "Mains", des: "Desserts", drk: "Drinks",
    btn: "View Order", title: "Your Order",
    msg: "üí° Read this list to the waiter.",
    clear: "Clear all", empty: "Empty list",
    notesPlaceholder: "Notes (e.g. no onions, ice with drink...)"
  },
  de: {
    all: "Alle", ent: "Vorspeisen", main: "Hauptspeisen", des: "Desserts", drk: "Getr√§nke",
    btn: "Bestellung", title: "Bestellung",
    msg: "üí° Lies dies dem Kellner vor.",
    clear: "L√∂schen", empty: "Leer",
    notesPlaceholder: "Notizen (z.B. keine Zwiebeln...)"
  },
  fr: {
    all: "Tous", ent: "Entr√©es", main: "Plats", des: "Desserts", drk: "Boissons",
    btn: "Commande", title: "Votre Commande",
    msg: "üí° Lisez ceci au serveur.",
    clear: "Effacer", empty: "Vide",
    notesPlaceholder: "Notes (ex. sans oignon...)"
  },
  it: {
    all: "Tutti", ent: "Antipasti", main: "Primi/Secondi", des: "Dolci", drk: "Bevande",
    btn: "Ordine", title: "Il tuo Ordine",
    msg: "üí° Leggi questo al cameriere.",
    clear: "Cancella", empty: "Vuota",
    notesPlaceholder: "Note (es. senza cipolla...)"
  }
};

/* --- DATOS (Ahora con Bebidas) --- */
const menu = [
  { id: 1, cat: 'entrantes', price: 6.50,
    name: { es: "Croquetas (4ud)", en: "Croquettes (4pcs)", de: "Kroketten (4 Stk)", fr: "Croquettes (4pcs)", it: "Crocchette (4pz)" },
    desc: { es: "Jam√≥n ib√©rico.", en: "Iberian ham.", de: "Iberischer Schinken.", fr: "Jambon ib√©rique.", it: "Prosciutto iberico." }
  },
  { id: 2, cat: 'entrantes', price: 7.50,
    name: { es: "Patatas Bravas", en: "Patatas Bravas", de: "Patatas Bravas", fr: "Patatas Bravas", it: "Patatas Bravas" },
    desc: { es: "Salsa picante.", en: "Spicy sauce.", de: "Scharfe Sauce.", fr: "Sauce piquante.", it: "Salsa piccante." }
  },
  { id: 3, cat: 'principales', price: 12.00,
    name: { es: "Burger Cl√°sica", en: "Classic Burger", de: "Klassischer Burger", fr: "Burger Classique", it: "Burger Classico" },
    desc: { es: "100% Ternera.", en: "100% Beef.", de: "100% Rindfleisch.", fr: "100% B≈ìuf.", it: "100% Manzo." }
  },
  { id: 4, cat: 'principales', price: 14.50,
    name: { es: "Salm√≥n", en: "Salmon", de: "Lachs", fr: "Saumon", it: "Salmone" },
    desc: { es: "Con verduras.", en: "With veggies.", de: "Mit Gem√ºse.", fr: "Aux l√©gumes.", it: "Con verdure." }
  },
  { id: 5, cat: 'postres', price: 5.50,
    name: { es: "Tarta de Queso", en: "Cheesecake", de: "K√§sekuchen", fr: "G√¢teau au fromage", it: "Cheesecake" },
    desc: { es: "Casera.", en: "Homemade.", de: "Hausgemacht.", fr: "Fait maison.", it: "Fatto in casa." }
  },
  // BEBIDAS
  { id: 6, cat: 'bebidas', price: 2.50,
    name: { es: "Refresco", en: "Soft Drink", de: "Erfrischungsgetr√§nk", fr: "Boisson gazeuse", it: "Bibita" },
    desc: { es: "Coca-Cola, Fanta...", en: "Coke, Fanta...", de: "Cola, Fanta...", fr: "Coca, Fanta...", it: "Coca, Fanta..." }
  },
  { id: 7, cat: 'bebidas', price: 2.00,
    name: { es: "Agua Mineral", en: "Water", de: "Wasser", fr: "Eau", it: "Acqua" },
    desc: { es: "50cl.", en: "50cl.", de: "50cl.", fr: "50cl.", it: "50cl." }
  },
  { id: 8, cat: 'bebidas', price: 3.00,
    name: { es: "Cerveza", en: "Beer", de: "Bier", fr: "Bi√®re", it: "Birra" },
    desc: { es: "Ca√±a / Botella.", en: "Draft / Bottle.", de: "Vom Fass / Flasche.", fr: "Pression / Bouteille.", it: "Spina / Bottiglia." }
  },
  { id: 9, cat: 'bebidas', price: 3.50,
    name: { es: "Copa de Vino", en: "Glass of Wine", de: "Glas Wein", fr: "Verre de vin", it: "Bicchiere di Vino" },
    desc: { es: "Tinto o Blanco.", en: "Red or White.", de: "Rot oder Wei√ü.", fr: "Rouge ou Blanc.", it: "Rosso o Bianco." }
  }
];

/* --- ESTADO --- */
let cart = {};
let currentFilter = 'all';
let currentLang = 'es';

/* --- LOGICA --- */
function initLanguage() {
  const urlParams = new URLSearchParams(window.location.search);
  const paramLang = urlParams.get('lang');
  const savedLang = localStorage.getItem('userLang');
  const browserLang = navigator.language.slice(0,2);
  const supported = ['es', 'en', 'de', 'fr', 'it'];
  
  if (paramLang && supported.includes(paramLang)) currentLang = paramLang;
  else if (savedLang && supported.includes(savedLang)) currentLang = savedLang;
  else if (supported.includes(browserLang)) currentLang = browserLang;
  
  localStorage.setItem('userLang', currentLang);
  document.getElementById('langDisplay').innerText = currentLang;
  render();
}

function render() {
  const container = document.getElementById('menuContainer');
  container.innerHTML = '';
  const txt = i18n[currentLang];

  // UI Texts
  document.getElementById('f-all').innerText = txt.all;
  document.getElementById('f-ent').innerText = txt.ent;
  document.getElementById('f-main').innerText = txt.main;
  document.getElementById('f-des').innerText = txt.des;
  document.getElementById('f-drk').innerText = txt.drk; // Filtro Bebidas
  document.getElementById('btnText').innerText = txt.btn;
  document.getElementById('modalTitle').innerText = txt.title;
  document.getElementById('waiterMsg').innerText = txt.msg;
  document.getElementById('clearTxt').innerText = txt.clear;
  document.getElementById('notesField').placeholder = txt.notesPlaceholder;

  menu.forEach(p => {
    if(currentFilter !== 'all' && p.cat !== currentFilter) return;

    const qty = cart[p.id] || 0;
    let btnContent = '+';
    let btnClass = 'add-btn';
    
    if (qty > 0) {
      btnContent = `${qty} +`;
      btnClass += ' has-items';
    }

    container.innerHTML += `
      <div class="product-card">
        <div class="card-info">
          <div class="product-name">${p.name[currentLang]}</div>
          <div class="product-desc">${p.desc[currentLang]}</div>
        </div>
        <div class="card-actions">
          <div class="product-price">${p.price.toFixed(2)}‚Ç¨</div>
          <button class="${btnClass}" onclick="add(${p.id})">${btnContent}</button>
        </div>
      </div>
    `;
  });
}

function add(id) {
  cart[id] = (cart[id] || 0) + 1;
  render(); updateFloatBtn(); 
  if(document.getElementById('overlay').classList.contains('open')) renderCartList();
  if(navigator.vibrate) navigator.vibrate(10);
}

function remove(id) {
  if(cart[id]) {
    cart[id]--;
    if(cart[id] <= 0) delete cart[id];
  }
  render(); renderCartList(); updateFloatBtn();
}

function updateFloatBtn() {
  const count = Object.values(cart).reduce((a,b)=>a+b,0);
  let total = 0;
  Object.keys(cart).forEach(id => {
    const p = menu.find(i=>i.id == id);
    if(p) total += p.price * cart[id];
  });
  
  document.getElementById('countBadge').innerText = count;
  document.getElementById('totalPriceFloat').innerText = total.toFixed(2) + '‚Ç¨';
  document.getElementById('sheetTotal').innerText = total.toFixed(2) + '‚Ç¨';
  
  const btn = document.getElementById('cart-float');
  if(count > 0) btn.classList.add('visible'); else btn.classList.remove('visible');
}

function renderCartList() {
  const list = document.getElementById('orderList');
  list.innerHTML = '';
  
  if(Object.keys(cart).length === 0) {
    list.innerHTML = `<div style="text-align:center; padding:20px; color:var(--muted)">${i18n[currentLang].empty}</div>`;
  } else {
    Object.keys(cart).forEach(id => {
      const p = menu.find(i=>i.id == id);
      const qty = cart[id];
      list.innerHTML += `
        <div class="order-row">
          <div>
            <div style="font-weight:700">${p.name[currentLang]}</div>
            <div style="font-size:0.85rem; color:var(--muted)">${p.price.toFixed(2)}‚Ç¨ x ${qty}</div>
          </div>
          <div class="qty-wrap">
            <button class="q-btn" onclick="remove(${id})">-</button>
            <span style="font-weight:600; min-width:15px; text-align:center">${qty}</span>
            <button class="q-btn" onclick="add(${id})">+</button>
          </div>
        </div>
      `;
    });
  }
  updateFloatBtn(); // Asegura que el total del modal se actualice
}

function clearCart() {
  if(confirm(i18n[currentLang].clear + '?')) {
    cart = {};
    document.getElementById('notesField').value = ''; // Limpiar notas tambi√©n
    render(); updateFloatBtn(); closeSheet();
  }
}

// Guardar notas (opcional, por si cierran el modal sin querer)
function saveNotes() {
  // Aqu√≠ podr√≠as guardar en localStorage si quisieras persistencia
}

function filter(cat) {
  currentFilter = cat;
  document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
  let id = 'f-all';
  if(cat==='entrantes') id='f-ent';
  if(cat==='principales') id='f-main';
  if(cat==='postres') id='f-des';
  if(cat==='bebidas') id='f-drk';
  document.getElementById(id).classList.add('active');
  render();
}

function openSheet() { renderCartList(); document.getElementById('overlay').classList.add('open'); }
function closeSheet() { document.getElementById('overlay').classList.remove('open'); }

/* --- THEME --- */
const themeBtn = document.getElementById('themeBtn');
let isDark = localStorage.getItem('theme') === 'dark';
function applyTheme() {
  document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light');
  themeBtn.innerHTML = isDark 
    ? '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>'
    : '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>';
}
themeBtn.addEventListener('click', () => {
  isDark = !isDark;
  localStorage.setItem('theme', isDark ? 'dark' : 'light');
  applyTheme();
});

// Inicializar
applyTheme();
initLanguage();

</script>
</body>
</html>
