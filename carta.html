<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes, maximum-scale=1" />
<title>Carta Digital</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">

<style>
:root {
  /* --- Paleta Premium --- */
  --bg-body: #f8f9fa;
  --bg-card: #ffffff;
  --text-main: #1a1a1a;
  --text-sec: #666666;
  --accent: #111111; 
  --accent-text: #ffffff;
  --shadow-card: 0 4px 24px rgba(0,0,0,0.04);
  --shadow-float: 0 15px 30px rgba(0,0,0,0.15);
  --border: rgba(0,0,0,0.06);
  --radius: 18px;
  --font: 'Manrope', sans-serif;
  --spanish-btn: #FFC107; /* Amarillo sutil para destacar el bot√≥n de espa√±ol */
}

[data-theme="dark"] {
  --bg-body: #0a0a0a;
  --bg-card: #161616;
  --text-main: #f0f0f0;
  --text-sec: #888888;
  --accent: #ffffff;
  --accent-text: #000000;
  --shadow-card: 0 4px 24px rgba(0,0,0,0.2);
  --border: rgba(255,255,255,0.08);
  --spanish-btn: #FFD54F;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
  margin: 0; background: var(--bg-body); color: var(--text-main); font-family: var(--font);
  transition: background 0.4s ease; padding-bottom: 120px;
  background-image: radial-gradient(at 0% 0%, rgba(0,0,0,0.03) 0px, transparent 50%), radial-gradient(at 100% 0%, rgba(0,0,0,0.03) 0px, transparent 50%);
}
[data-theme="dark"] body {
  background-image: radial-gradient(at 0% 0%, rgba(255,255,255,0.03) 0px, transparent 50%), radial-gradient(at 100% 0%, rgba(255,255,255,0.03) 0px, transparent 50%);
}

/* Header */
.header {
  position: sticky; top: 0; z-index: 100;
  background: rgba(var(--bg-card), 0.01); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
  padding: 16px 24px; display: flex; justify-content: space-between; align-items: center;
}
.brand { font-size: 1.5rem; font-weight: 800; letter-spacing: -0.03em; }
.controls { display: flex; align-items: center; gap: 12px; }
.lang-badge { font-size: 0.75rem; font-weight: 800; text-transform: uppercase; border: 2px solid var(--border); padding: 4px 10px; border-radius: 20px; }
.theme-btn { background: none; border: none; cursor: pointer; padding: 0; color: var(--text-main); display: flex; }

/* Filtros */
.filters-wrap {
  position: sticky; top: 70px; z-index: 90; padding: 10px 0; margin-bottom: 20px;
  mask-image: linear-gradient(to right, transparent, black 20px, black 90%, transparent); -webkit-mask-image: linear-gradient(to right, transparent, black 20px, black 90%, transparent);
}
.filters-scroll { display: flex; gap: 12px; overflow-x: auto; padding: 0 24px; scrollbar-width: none; }
.filters-scroll::-webkit-scrollbar { display: none; }
.filter-pill {
  padding: 10px 20px; background: transparent; border: none; border-radius: 30px; 
  white-space: nowrap; font-size: 0.95rem; font-weight: 600; color: var(--text-sec); cursor: pointer; transition: 0.3s;
}
.filter-pill.active { color: var(--text-main); background: var(--bg-card); box-shadow: 0 4px 12px rgba(0,0,0,0.05); font-weight: 800; }
[data-theme="dark"] .filter-pill.active { background: #222; }

/* Grid Platos */
.menu-grid { display: flex; flex-direction: column; gap: 16px; padding: 0 20px; max-width: 700px; margin: 0 auto; }
.dish-card {
  background: var(--bg-card); border-radius: var(--radius); padding: 18px;
  display: flex; align-items: center; justify-content: space-between; gap: 16px;
  box-shadow: var(--shadow-card); border: 1px solid var(--border); transition: 0.2s;
}
.dish-card:active { transform: scale(0.98); }
.dish-info { flex: 1; }
.dish-header { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 6px; }
.dish-name { font-weight: 700; font-size: 1.05rem; letter-spacing: -0.02em; }
.dish-desc { font-size: 0.85rem; color: var(--text-sec); line-height: 1.4; font-weight: 500; }
.dish-actions { display: flex; flex-direction: column; align-items: flex-end; gap: 8px; min-width: 70px; }
.dish-price { font-weight: 800; font-size: 1rem; }
.add-btn {
  background: var(--bg-body); color: var(--text-main); border: none; height: 38px; padding: 0 16px; 
  border-radius: 12px; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: 0.3s; box-shadow: inset 0 0 0 1px var(--border);
}
.add-btn.active { background: var(--accent); color: var(--accent-text); box-shadow: 0 4px 10px rgba(0,0,0,0.2); }

/* Float Button */
#cart-float {
  position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(150px) scale(0.9);
  background: rgba(20, 20, 20, 0.9); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
  color: white; padding: 16px 30px; border-radius: 100px; display: flex; align-items: center; gap: 16px;
  box-shadow: var(--shadow-float); cursor: pointer; z-index: 1000; transition: 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
  font-weight: 600;
}
[data-theme="dark"] #cart-float { background: rgba(255, 255, 255, 0.9); color: black; }
#cart-float.visible { transform: translateX(-50%) translateY(0) scale(1); }
.badge-count { background: #FF4757; color: white; padding: 2px 8px; border-radius: 50px; font-size: 0.75rem; font-weight: 800; }

/* Modal Sheet */
.overlay {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); backdrop-filter: blur(6px);
  z-index: 2000; opacity: 0; pointer-events: none; transition: 0.3s; display: flex; justify-content: center; align-items: flex-end;
}
.overlay.open { opacity: 1; pointer-events: auto; }
.sheet {
  background: var(--bg-card); width: 100%; max-width: 600px; max-height: 92vh; border-radius: 32px 32px 0 0;
  padding: 30px; display: flex; flex-direction: column; transform: translateY(100%); transition: 0.4s cubic-bezier(0.19, 1, 0.22, 1);
  box-shadow: 0 -10px 40px rgba(0,0,0,0.1);
}
.overlay.open .sheet { transform: translateY(0); }

.sheet-header { 
  display: flex; flex-direction: column; gap: 10px; margin-bottom: 24px; padding-bottom: 20px; border-bottom: 1px dashed var(--border); 
}
.header-top { display: flex; justify-content: space-between; align-items: center; width: 100%; }

/* BOT√ìN DE TRADUCCI√ìN M√ÅGICO */
.translate-btn {
  display: none; /* Oculto por defecto */
  align-items: center; justify-content: center; gap: 8px;
  width: 100%; padding: 12px; border-radius: 12px;
  background: rgba(0,0,0,0.03); border: 1px solid var(--border);
  font-weight: 700; font-size: 0.9rem; cursor: pointer; color: var(--text-sec);
  transition: 0.2s;
}
.translate-btn.active {
  background: var(--spanish-btn); color: black; border-color: var(--spanish-btn);
}

.order-list { overflow-y: auto; flex: 1; display: flex; flex-direction: column; gap: 12px; margin-bottom: 20px; }
.order-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--border); }
.qty-controls { display: flex; align-items: center; gap: 12px; background: var(--bg-body); padding: 4px; border-radius: 50px; }
.qty-btn { width: 32px; height: 32px; border-radius: 50%; border: none; background: var(--bg-card); color: var(--text-main); font-weight: 700; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }

.total-box { background: var(--bg-body); padding: 20px; border-radius: 20px; }
.total-row { display: flex; justify-content: space-between; font-size: 1.2rem; font-weight: 800; margin-bottom: 15px; }
textarea.notes {
  width: 100%; padding: 12px; border-radius: 12px; background: var(--bg-card); border: 1px solid var(--border);
  color: var(--text-main); font-family: inherit; resize: none; outline: none; font-size: 0.9rem; margin-bottom: 10px;
}
</style>
</head>
<body>

<header class="header">
  <div class="brand">Carta</div>
  <div class="controls">
    <div class="lang-badge" id="langDisplay">ES</div>
    <button class="theme-btn" id="themeBtn"></button>
  </div>
</header>

<div class="filters-wrap">
  <div class="filters-scroll">
    <button class="filter-pill active" onclick="filter('bebidas')" id="f-drk">Bebidas</button>
    <button class="filter-pill" onclick="filter('entrantes')" id="f-ent">Entrantes</button>
    <button class="filter-pill" onclick="filter('principales')" id="f-main">Principales</button>
    <button class="filter-pill" onclick="filter('postres')" id="f-des">Postres</button>
  </div>
</div>

<div class="menu-grid" id="menuContainer"></div>

<div id="cart-float" onclick="openSheet()">
  <span class="badge-count" id="countBadge">0</span>
  <span id="btnText">Ver Pedido</span>
  <span id="totalPriceFloat" style="margin-left:auto; opacity:0.7">0.00‚Ç¨</span>
</div>

<div class="overlay" id="overlay" onclick="if(event.target===this) closeSheet()">
  <div class="sheet">
    <div class="sheet-header">
      <div class="header-top">
        <h3 style="margin:0; font-size:1.5rem; letter-spacing:-0.03em" id="modalTitle">Tu Pedido</h3>
        <div onclick="closeSheet()" style="cursor:pointer; padding:5px; opacity:0.5; font-size:1.5rem">√ó</div>
      </div>
      
      <button id="translateBtn" class="translate-btn" onclick="toggleWaiterMode()">
        <span id="transIcon">üá™üá∏</span> <span id="transText">Mostrar en Espa√±ol (Camarero)</span>
      </button>
    </div>
    
    <div class="order-list" id="orderList"></div>

    <div class="total-box">
      <div class="total-row">
        <span>Total</span>
        <span id="sheetTotal">0.00‚Ç¨</span>
      </div>
      <textarea class="notes" id="notesField" placeholder="Notas..."></textarea>
      <div style="text-align:center; font-size:0.8rem; color:var(--text-sec); margin-top:8px" id="waiterMsg">üí° Lee esto al camarero.</div>
    </div>
    
    <div style="text-align:center; margin-top:15px">
      <button onclick="clearCart()" style="background:none; border:none; color:var(--text-sec); text-decoration:underline; cursor:pointer; font-size:0.9rem" id="clearTxt">Borrar lista</button>
    </div>
  </div>
</div>

<script>
/* --- DICCIONARIO --- */
const i18n = {
  es: { ent: "Entrantes", main: "Principales", des: "Postres", drk: "Bebidas", btn: "Ver Lista", title: "Tu Pedido", msg: "üí° Lee esta lista al camarero/a.", clear: "Borrar todo", empty: "Lista vac√≠a", ph: "Notas (ej. sin hielo...)", trans: "Ya est√°s en espa√±ol" },
  en: { ent: "Starters", main: "Mains", des: "Desserts", drk: "Drinks", btn: "View List", title: "Your Order", msg: "üí° Read this list to the waiter.", clear: "Clear all", empty: "Empty list", ph: "Notes (e.g. no ice...)", trans: "üá™üá∏ Show in Spanish (Waiter)" },
  de: { ent: "Vorspeisen", main: "Hauptspeisen", des: "Desserts", drk: "Getr√§nke", btn: "Liste", title: "Bestellung", msg: "üí° Dem Kellner vorlesen.", clear: "L√∂schen", empty: "Leer", ph: "Notizen...", trans: "üá™üá∏ Auf Spanisch anzeigen (Kellner)" },
  fr: { ent: "Entr√©es", main: "Plats", des: "Desserts", drk: "Boissons", btn: "Voir liste", title: "Commande", msg: "üí° Lire au serveur.", clear: "Effacer", empty: "Vide", ph: "Notes...", trans: "üá™üá∏ Voir en Espagnol (Serveur)" },
  it: { ent: "Antipasti", main: "Primi/Secondi", des: "Dolci", drk: "Bevande", btn: "Vedi lista", title: "Ordine", msg: "üí° Leggi al cameriere.", clear: "Cancella", empty: "Vuota", ph: "Note...", trans: "üá™üá∏ Mostra in Spagnolo (Cameriere)" }
};

/* --- DATOS --- */
const menu = [
  // BEBIDAS
  { id: 100, cat: 'bebidas', price: 2.50,
    name: { es: "Refresco", en: "Soft Drink", de: "Erfrischungsgetr√§nk", fr: "Boisson gazeuse", it: "Bibita" },
    desc: { es: "Coca-Cola, Fanta, Sprite.", en: "Coke, Fanta, Sprite.", de: "Cola, Fanta, Sprite.", fr: "Coca, Fanta, Sprite.", it: "Coca, Fanta, Sprite." }
  },
  { id: 101, cat: 'bebidas', price: 2.00,
    name: { es: "Agua Mineral", en: "Water", de: "Wasser", fr: "Eau", it: "Acqua" },
    desc: { es: "Botella 50cl.", en: "50cl Bottle.", de: "50cl Flasche.", fr: "Bouteille 50cl.", it: "Bottiglia 50cl." }
  },
  { id: 102, cat: 'bebidas', price: 3.00,
    name: { es: "Cerveza", en: "Beer", de: "Bier", fr: "Bi√®re", it: "Birra" },
    desc: { es: "Nacional / Importaci√≥n.", en: "Local / Import.", de: "Lokal / Import.", fr: "Locale / Import√©e.", it: "Locale / Importata." }
  },
  { id: 103, cat: 'bebidas', price: 18.00,
    name: { es: "Botella de Vino", en: "Bottle of Wine", de: "Flasche Wein", fr: "Bouteille de vin", it: "Bottiglia di Vino" },
    desc: { es: "Rioja / Ribera.", en: "Rioja / Ribera.", de: "Rioja / Ribera.", fr: "Rioja / Ribera.", it: "Rioja / Ribera." }
  },
  // COMIDA
  { id: 1, cat: 'entrantes', price: 9.50,
    name: { es: "Huevos Rotos", en: "Broken Eggs", de: "Zerbrochene Eier", fr: "≈íufs cass√©s", it: "Uova rotte" },
    desc: { es: "Con jam√≥n ib√©rico.", en: "With Iberian ham.", de: "Mit iberischem Schinken.", fr: "Au jambon ib√©rique.", it: "Con prosciutto iberico." }
  },
  { id: 2, cat: 'entrantes', price: 6.50,
    name: { es: "Croquetas (4ud)", en: "Croquettes (4pcs)", de: "Kroketten (4 Stk)", fr: "Croquettes (4pcs)", it: "Crocchette (4pz)" },
    desc: { es: "Boletus y Trufa.", en: "Boletus & Truffle.", de: "Steinpilz & Tr√ºffel.", fr: "C√®pes et Truffe.", it: "Porcini e Tartufo." }
  },
  { id: 3, cat: 'principales', price: 16.00,
    name: { es: "Entrecot Vaca", en: "Beef Entrecote", de: "Rinderentrecote", fr: "Entrec√¥te de b≈ìuf", it: "Entrecote di manzo" },
    desc: { es: "300g a la parrilla.", en: "300g grilled.", de: "300g gegrillt.", fr: "300g grill√©.", it: "300g alla griglia." }
  },
  { id: 4, cat: 'principales', price: 12.50,
    name: { es: "Burger Premium", en: "Premium Burger", de: "Premium Burger", fr: "Burger Premium", it: "Burger Premium" },
    desc: { es: "Queso de cabra y cebolla.", en: "Goat cheese & onion.", de: "Ziegenk√§se & Zwiebel.", fr: "Ch√®vre et oignon.", it: "Formaggio di capra e cipolla." }
  },
  { id: 5, cat: 'postres', price: 6.00,
    name: { es: "Coulant Choco", en: "Choco Coulant", de: "Schoko-Coulant", fr: "Coulant au chocolat", it: "Coulant al cioccolato" },
    desc: { es: "Con helado.", en: "With ice cream.", de: "Mit Eis.", fr: "Avec glace.", it: "Con gelato." }
  }
];

let cart = {};
let filterCat = 'bebidas';
let lang = 'es';
let waiterMode = false; // Estado del interruptor

/* --- LOGICA --- */
function init() {
  const urlP = new URLSearchParams(window.location.search).get('lang');
  const saved = localStorage.getItem('userLang');
  const browser = navigator.language.slice(0,2);
  
  if(urlP && i18n[urlP]) lang = urlP;
  else if(saved && i18n[saved]) lang = saved;
  else if(i18n[browser]) lang = browser;
  
  localStorage.setItem('userLang', lang);
  document.getElementById('langDisplay').innerText = lang;
  render();
}

function render() {
  const list = document.getElementById('menuContainer');
  list.innerHTML = '';
  const txt = i18n[lang];

  // Actualizar Textos
  document.getElementById('f-ent').innerText = txt.ent;
  document.getElementById('f-main').innerText = txt.main;
  document.getElementById('f-des').innerText = txt.des;
  document.getElementById('f-drk').innerText = txt.drk;
  document.getElementById('btnText').innerText = txt.btn;
  document.getElementById('modalTitle').innerText = txt.title;
  document.getElementById('waiterMsg').innerText = txt.msg;
  document.getElementById('clearTxt').innerText = txt.clear;
  document.getElementById('notesField').placeholder = txt.ph;
  document.getElementById('transText').innerText = txt.trans;

  // L√≥gica de visualizaci√≥n del bot√≥n traducir
  const transBtn = document.getElementById('translateBtn');
  if (lang !== 'es') {
    transBtn.style.display = 'flex'; // Mostrar si no es ES
  } else {
    transBtn.style.display = 'none'; // Ocultar si ya es ES
  }

  menu.forEach(p => {
    if(p.cat !== filterCat) return;

    const qty = cart[p.id] || 0;
    let btnTxt = '+';
    let btnClass = 'add-btn';
    
    if(qty > 0) {
      btnTxt = `${qty} +`;
      btnClass += ' active';
    }

    list.innerHTML += `
      <div class="dish-card">
        <div class="dish-info">
          <div class="dish-header">
            <span class="dish-name">${p.name[lang]}</span>
          </div>
          <div class="dish-desc">${p.desc[lang]}</div>
        </div>
        <div class="dish-actions">
          <span class="dish-price">${p.price.toFixed(2)}‚Ç¨</span>
          <button class="${btnClass}" onclick="add(${p.id})">${btnTxt}</button>
        </div>
      </div>
    `;
  });
}

function add(id) {
  cart[id] = (cart[id] || 0) + 1;
  render(); updateFloat();
  if(document.getElementById('overlay').classList.contains('open')) renderList();
  if(navigator.vibrate) navigator.vibrate(10);
}

function remove(id) {
  if(cart[id]) {
    cart[id]--;
    if(cart[id] <= 0) delete cart[id];
  }
  render(); updateFloat(); renderList();
}

function updateFloat() {
  const count = Object.values(cart).reduce((a,b)=>a+b,0);
  let total = 0;
  Object.keys(cart).forEach(id => {
    const p = menu.find(x => x.id == id);
    if(p) total += p.price * cart[id];
  });

  document.getElementById('countBadge').innerText = count;
  document.getElementById('totalPriceFloat').innerText = total.toFixed(2) + '‚Ç¨';
  document.getElementById('sheetTotal').innerText = total.toFixed(2) + '‚Ç¨';
  
  const btn = document.getElementById('cart-float');
  if(count > 0) btn.classList.add('visible'); else btn.classList.remove('visible');
}

/* --- LOGICA MODO CAMARERO --- */
function toggleWaiterMode() {
  waiterMode = !waiterMode; // Alternar estado
  const btn = document.getElementById('translateBtn');
  
  if (waiterMode) {
    btn.classList.add('active');
    // Cambiar texto del bot√≥n para indicar que est√° activo
    // (Opcional, pero ayuda visualmente)
  } else {
    btn.classList.remove('active');
  }
  renderList(); // Re-renderizar la lista del modal
}

function renderList() {
  const cont = document.getElementById('orderList');
  cont.innerHTML = '';
  
  // Determinar idioma a usar en la lista del modal
  // Si waiterMode es true -> forzar 'es'. Si no -> usar 'lang' (idioma del usuario)
  const displayLang = waiterMode ? 'es' : lang;

  if(Object.keys(cart).length === 0) {
    cont.innerHTML = `<div style="text-align:center; padding:30px; color:var(--text-sec)">${i18n[lang].empty}</div>`;
  } else {
    Object.keys(cart).forEach(id => {
      const p = menu.find(x => x.id == id);
      const qty = cart[id];
      
      // Animaci√≥n de cambio de texto
      cont.innerHTML += `
        <div class="order-item">
          <div>
            <div style="font-weight:700; font-size:1rem; transition:0.3s">${p.name[displayLang]}</div>
            <div style="font-size:0.85rem; color:var(--text-sec)">${p.price.toFixed(2)}‚Ç¨ x ${qty}</div>
          </div>
          <div class="qty-controls">
            <button class="qty-btn" onclick="remove(${id})">-</button>
            <span style="font-weight:700; width:20px; text-align:center">${qty}</span>
            <button class="qty-btn" onclick="add(${id})">+</button>
          </div>
        </div>
      `;
    });
  }
}

function filter(cat) {
  filterCat = cat;
  document.querySelectorAll('.filter-pill').forEach(b => b.classList.remove('active'));
  let id='f-drk';
  if(cat==='entrantes') id='f-ent';
  if(cat==='principales') id='f-main';
  if(cat==='postres') id='f-des';
  document.getElementById(id).classList.add('active');
  render();
}

function clearCart() {
  if(confirm(i18n[lang].clear + '?')) {
    cart = {}; document.getElementById('notesField').value = '';
    waiterMode = false; // Resetear modo camarero
    render(); updateFloat(); closeSheet();
  }
}

function openSheet() { 
  // Al abrir siempre mostramos el idioma del usuario primero
  waiterMode = false;
  document.getElementById('translateBtn').classList.remove('active');
  renderList(); 
  document.getElementById('overlay').classList.add('open'); 
}
function closeSheet() { document.getElementById('overlay').classList.remove('open'); }

/* --- THEME --- */
const themeBtn = document.getElementById('themeBtn');
let isDark = localStorage.getItem('theme') === 'dark';

function applyTheme() {
  document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light');
  themeBtn.innerHTML = isDark 
    ? '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>'
    : '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>';
}
themeBtn.addEventListener('click', () => {
  isDark = !isDark;
  localStorage.setItem('theme', isDark ? 'dark' : 'light');
  applyTheme();
});

// Init
applyTheme();
init();
</script>
</body>
</html>