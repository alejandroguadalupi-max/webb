<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes, maximum-scale=1" />
<title>Carta</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root {
  /* Paleta Premium (Mismo dise√±o que te gust√≥) */
  --bg-light: #F9FAFB;
  --bg-dark: #0D0D0D;
  
  --card-light: #FFFFFF;
  --card-dark: #1C1C1E;
  
  --text-light: #1F2937;
  --text-dark: #F3F4F6;
  
  --muted-light: #6B7280;
  --muted-dark: #9CA3AF;
  
  --accent: #68B553; 
  --accent-rgb: 104, 181, 83;
  
  --shadow-sm: 0 2px 8px rgba(0,0,0,0.04);
  --shadow-md: 0 8px 24px -6px rgba(0,0,0,0.06);
  --shadow-float: 0 20px 40px -10px rgba(104, 181, 83, 0.3);
  
  --radius: 20px;
  --font: 'Plus Jakarta Sans', sans-serif;
}

[data-theme="dark"] {
  --bg: var(--bg-dark);
  --card: var(--card-dark);
  --text: var(--text-dark);
  --muted: var(--muted-dark);
  --border: rgba(255,255,255,0.08);
  --glass: rgba(28, 28, 30, 0.8);
}

[data-theme="light"] {
  --bg: var(--bg-light);
  --card: var(--card-light);
  --text: var(--text-light);
  --muted: var(--muted-light);
  --border: rgba(0,0,0,0.06);
  --glass: rgba(255, 255, 255, 0.8);
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: var(--font);
  transition: background 0.3s ease, color 0.3s ease;
  padding-bottom: 100px;
}

/* --- Header Glassmorphism --- */
.header {
  position: sticky;
  top: 0;
  z-index: 100;
  background: var(--glass);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  padding: 16px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid var(--border);
}

.brand {
  font-size: 1.3rem;
  font-weight: 800;
  letter-spacing: -0.5px;
}

.controls {
  display: flex;
  align-items: center;
  gap: 12px;
}

/* Selector idioma estilo bot√≥n */
.lang-select {
  background: var(--bg);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 6px 10px;
  font-family: inherit;
  font-weight: 600;
  font-size: 0.85rem;
  outline: none;
  cursor: pointer;
}

.theme-toggle {
  background: none;
  border: none;
  cursor: pointer;
  padding: 8px;
  color: var(--text);
  display: flex;
}

/* --- Filtros (Chips deslizantes) --- */
.filters-wrap {
  position: sticky;
  top: 73px; 
  z-index: 90;
  background: var(--bg);
  padding: 12px 0;
  margin-bottom: 10px;
}

.filters-scroll {
  display: flex;
  gap: 10px;
  overflow-x: auto;
  padding: 0 20px;
  scrollbar-width: none;
}
.filters-scroll::-webkit-scrollbar { display: none; }

.filter-chip {
  padding: 8px 18px;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 50px;
  white-space: nowrap;
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--muted);
  cursor: pointer;
  transition: all 0.2s ease;
}

.filter-chip.active {
  background: var(--text);
  color: var(--bg);
  border-color: var(--text);
  transform: scale(1.05);
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

/* --- Grid de Productos (Sin fotos) --- */
.menu-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); /* Adaptable */
  gap: 16px;
  padding: 0 20px;
  max-width: 1000px;
  margin: 0 auto;
}

.product-card {
  background: var(--card);
  border-radius: var(--radius);
  padding: 20px;
  border: 1px solid var(--border);
  transition: transform 0.2s, box-shadow 0.2s;
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  height: 100%;
}

.product-card:active { transform: scale(0.98); }

.card-top {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 8px;
}

.product-name {
  font-weight: 700;
  font-size: 1.1rem;
  line-height: 1.3;
  margin-right: 10px;
}

.product-price {
  font-weight: 700;
  font-size: 1.1rem;
  color: var(--accent);
  white-space: nowrap;
}

.product-desc {
  font-size: 0.9rem;
  color: var(--muted);
  line-height: 1.5;
  margin-bottom: 16px;
}

.card-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: auto; /* Empuja al fondo */
}

/* Dots minimalistas para alergenos */
.allergy-dots { display: flex; gap: 6px; }
.dot { width: 10px; height: 10px; border-radius: 50%; opacity: 0.7; }
.dot-gluten { background: #FF9F43; } 
.dot-lactosa { background: #54A0FF; }
.dot-vegan { background: #10AC84; }

.add-btn {
  background: var(--bg);
  color: var(--text);
  border: 1px solid var(--border);
  width: 40px;
  height: 40px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.4rem;
  cursor: pointer;
  transition: 0.2s;
  box-shadow: var(--shadow-sm);
}
.add-btn:hover { background: var(--text); color: var(--bg); }

/* --- Bot√≥n Flotante (Pedido) --- */
#cart-float {
  position: fixed;
  bottom: 24px;
  left: 50%;
  transform: translateX(-50%) scale(0.9) translateY(100px);
  background: var(--text); 
  color: var(--bg);
  padding: 16px 28px;
  border-radius: 50px;
  display: flex;
  align-items: center;
  gap: 16px;
  box-shadow: var(--shadow-float);
  cursor: pointer;
  z-index: 1000;
  transition: 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  font-weight: 600;
}

#cart-float.visible { transform: translateX(-50%) scale(1) translateY(0); }

.badge-count {
  background: var(--accent);
  color: white;
  padding: 2px 8px;
  border-radius: 10px;
  font-size: 0.85rem;
}

/* --- Panel Deslizante (Bottom Sheet) --- */
.overlay {
  position: fixed;
  top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(4px);
  z-index: 2000;
  opacity: 0;
  pointer-events: none;
  transition: 0.3s;
  display: flex;
  justify-content: center;
  align-items: flex-end;
}

.overlay.open { opacity: 1; pointer-events: auto; }

.sheet {
  background: var(--card);
  width: 100%;
  max-width: 600px;
  max-height: 85vh;
  border-radius: 30px 30px 0 0;
  padding: 24px;
  display: flex;
  flex-direction: column;
  transform: translateY(100%);
  transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.overlay.open .sheet { transform: translateY(0); }

.sheet-header {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 20px; border-bottom: 1px solid var(--border); padding-bottom: 15px;
}

.order-items { overflow-y: auto; flex: 1; display: flex; flex-direction: column; gap: 12px; }

.order-row {
  display: flex; justify-content: space-between; align-items: center;
  padding: 12px; background: var(--bg); border-radius: 16px;
}

.qty-wrap { display: flex; align-items: center; gap: 12px; }
.q-btn {
  width: 32px; height: 32px; border-radius: 50%; border: none;
  background: var(--card); color: var(--text); font-weight: bold;
  box-shadow: var(--shadow-sm); cursor: pointer;
}

.waiter-note {
  background: rgba(104, 181, 83, 0.1);
  color: var(--accent);
  padding: 14px;
  border-radius: 16px;
  margin-top: 16px;
  text-align: center;
  font-weight: 600;
  font-size: 0.9rem;
}

</style>
</head>
<body>

<header class="header">
  <div class="brand">Carta</div>
  <div class="controls">
    <select class="lang-select" id="langSelect" onchange="changeLang(this.value)">
      <option value="es">ES</option>
      <option value="en">EN</option>
      <option value="ca">CA</option>
    </select>
    <button class="theme-toggle" id="themeBtn">
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
    </button>
  </div>
</header>

<div class="filters-wrap">
  <div class="filters-scroll">
    <div class="filter-chip active" onclick="filter('all')" id="f-all">Todos</div>
    <div class="filter-chip" onclick="filter('entrantes')" id="f-ent">Entrantes</div>
    <div class="filter-chip" onclick="filter('principales')" id="f-main">Principales</div>
    <div class="filter-chip" onclick="filter('postres')" id="f-des">Postres</div>
    <div class="filter-chip" onclick="filter('glutenfree')" id="f-gf">Sin Gluten</div>
  </div>
</div>

<div class="menu-grid" id="menuContainer">
  </div>

<div id="cart-float" onclick="openSheet()">
  <span class="badge-count" id="countBadge">0</span>
  <span id="btnText">Ver Pedido</span>
  <span id="totalPrice" style="margin-left:auto; opacity:0.8">0.00‚Ç¨</span>
</div>

<div class="overlay" id="overlay" onclick="if(event.target===this) closeSheet()">
  <div class="sheet">
    <div class="sheet-header">
      <h3 style="margin:0; font-size:1.4rem" id="modalTitle">Tu Pedido</h3>
      <div onclick="closeSheet()" style="cursor:pointer; padding:5px; font-weight:bold">‚úï</div>
    </div>
    
    <div class="order-items" id="orderList">
      </div>

    <div class="waiter-note" id="waiterMsg">
      üí° Lee esta lista al camarero/a para pedir.
    </div>

    <button onclick="clearCart()" style="width:100%; margin-top:15px; background:transparent; border:none; color:var(--muted); font-size:0.9rem; text-decoration:underline; cursor:pointer;">
      <span id="clearTxt">Borrar lista</span>
    </button>
  </div>
</div>

<script>
/* --- TRADUCCIONES --- */
const i18n = {
  es: {
    all: "Todos", ent: "Entrantes", main: "Principales", des: "Postres", gf: "Sin Gluten",
    btn: "Ver Pedido", title: "Tu Pedido",
    msg: "üí° Lee esta lista al camarero/a para pedir.",
    clear: "Borrar todo", empty: "Lista vac√≠a"
  },
  en: {
    all: "All", ent: "Starters", main: "Mains", des: "Desserts", gf: "Gluten Free",
    btn: "View Order", title: "Your Order",
    msg: "üí° Read this list to the waiter to order.",
    clear: "Clear all", empty: "Empty list"
  },
  ca: {
    all: "Tots", ent: "Entrants", main: "Principals", des: "Postres", gf: "Sense Gluten",
    btn: "Veure Comanda", title: "La teva Comanda",
    msg: "üí° Llegeix aquesta llista al cambrer/a per demanar.",
    clear: "Esborrar tot", empty: "Llista buida"
  }
};

/* --- DATOS --- */
const menu = [
  { id: 1, cat: 'entrantes', price: 6.50, tags: ['lactosa'],
    name: { es: "Croquetas Caseras", en: "Homemade Croquettes", ca: "Croquetes Casolanes" },
    desc: { es: "De jam√≥n ib√©rico (4 uds).", en: "Iberian ham (4 pcs).", ca: "De pernil ib√®ric (4 ut)." }
  },
  { id: 2, cat: 'entrantes', price: 9.00, tags: ['glutenfree', 'vegan'],
    name: { es: "Ensalada de Quinoa", en: "Quinoa Salad", ca: "Amanida de Quinoa" },
    desc: { es: "Con aguacate, mango y lima.", en: "With avocado, mango and lime.", ca: "Amb alvocat, mango i llima." }
  },
  { id: 3, cat: 'principales', price: 14.50, tags: ['glutenfree'],
    name: { es: "Salm√≥n Grill√©", en: "Grilled Salmon", ca: "Salm√≥ a la planxa" },
    desc: { es: "Con verduras al vapor.", en: "With steamed vegetables.", ca: "Amb verdures al vapor." }
  },
  { id: 4, cat: 'principales', price: 12.00, tags: [],
    name: { es: "Burger Cl√°sica", en: "Classic Burger", ca: "Burger Cl√†ssica" },
    desc: { es: "Ternera 100%, queso y salsa.", en: "100% Beef, cheese and sauce.", ca: "Vedella 100%, formatge i salsa." }
  },
  { id: 5, cat: 'postres', price: 5.50, tags: ['lactosa'],
    name: { es: "Tarta de Queso", en: "Cheesecake", ca: "Past√≠s de Formatge" },
    desc: { es: "Cremosa al horno.", en: "Baked creamy cake.", ca: "Crem√≥s al forn." }
  }
];

let lang = 'es';
let cart = {};
let currentFilter = 'all';

/* --- FUNCIONES --- */
function render() {
  const container = document.getElementById('menuContainer');
  container.innerHTML = '';
  const txt = i18n[lang];

  // Actualizar filtros txt
  document.getElementById('f-all').innerText = txt.all;
  document.getElementById('f-ent').innerText = txt.ent;
  document.getElementById('f-main').innerText = txt.main;
  document.getElementById('f-des').innerText = txt.des;
  document.getElementById('f-gf').innerText = txt.gf;
  document.getElementById('btnText').innerText = txt.btn;
  document.getElementById('modalTitle').innerText = txt.title;
  document.getElementById('waiterMsg').innerText = txt.msg;
  document.getElementById('clearTxt').innerText = txt.clear;

  menu.forEach(p => {
    let show = (currentFilter === 'all') || (p.cat === currentFilter);
    if(currentFilter === 'glutenfree' && p.tags.includes('glutenfree')) show = true;
    else if(currentFilter === 'glutenfree' && !p.tags.includes('glutenfree')) show = false;

    if(show) {
      // Dots visuales (sin texto)
      let dots = '';
      if(p.tags.includes('glutenfree')) dots += '<div class="dot dot-gluten" title="Sin Gluten"></div>';
      if(p.tags.includes('lactosa')) dots += '<div class="dot dot-lactosa" title="Lactosa"></div>';
      if(p.tags.includes('vegan')) dots += '<div class="dot dot-vegan" title="Vegan"></div>';

      container.innerHTML += `
        <div class="product-card">
          <div class="card-top">
            <div class="product-name">${p.name[lang]}</div>
            <div class="product-price">${p.price.toFixed(2)}‚Ç¨</div>
          </div>
          <div class="product-desc">${p.desc[lang]}</div>
          <div class="card-footer">
            <div class="allergy-dots">${dots}</div>
            <div class="add-btn" onclick="add(${p.id})">+</div>
          </div>
        </div>
      `;
    }
  });
}

function add(id) {
  cart[id] = (cart[id] || 0) + 1;
  updateBtn();
  // Vibraci√≥n sutil
  if(navigator.vibrate) navigator.vibrate(10);
}

function remove(id) {
  if(cart[id]) {
    cart[id]--;
    if(cart[id] <= 0) delete cart[id];
  }
  updateBtn();
  renderCart();
}

function updateBtn() {
  const count = Object.values(cart).reduce((a,b)=>a+b,0);
  let total = 0;
  Object.keys(cart).forEach(id => {
    const p = menu.find(i=>i.id == id);
    if(p) total += p.price * cart[id];
  });
  
  document.getElementById('countBadge').innerText = count;
  document.getElementById('totalPrice').innerText = total.toFixed(2) + '‚Ç¨';
  
  const btn = document.getElementById('cart-float');
  if(count > 0) btn.classList.add('visible');
  else btn.classList.remove('visible');
}

function renderCart() {
  const list = document.getElementById('orderList');
  list.innerHTML = '';
  
  if(Object.keys(cart).length === 0) {
    list.innerHTML = `<div style="text-align:center; padding:20px; color:var(--muted)">${i18n[lang].empty}</div>`;
    return;
  }

  Object.keys(cart).forEach(id => {
    const p = menu.find(i=>i.id == id);
    const qty = cart[id];
    list.innerHTML += `
      <div class="order-row">
        <div>
          <div style="font-weight:700">${p.name[lang]}</div>
          <div style="font-size:0.85rem; color:var(--muted)">${p.price.toFixed(2)}‚Ç¨ x ${qty}</div>
        </div>
        <div class="qty-wrap">
          <button class="q-btn" onclick="remove(${id})">-</button>
          <span style="font-weight:600; min-width:15px; text-align:center">${qty}</span>
          <button class="q-btn" onclick="add(${id}); renderCart()">+</button>
        </div>
      </div>
    `;
  });
}

function clearCart() {
  cart = {};
  updateBtn();
  closeSheet();
}

/* --- UI HELPERS --- */
function changeLang(val) { lang = val; render(); }

function filter(cat) {
  currentFilter = cat;
  document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
  // Mapeo simple de ID
  let id = 'f-all';
  if(cat==='entrantes') id='f-ent';
  if(cat==='principales') id='f-main';
  if(cat==='postres') id='f-des';
  if(cat==='glutenfree') id='f-gf';
  document.getElementById(id).classList.add('active');
  render();
}

function openSheet() { renderCart(); document.getElementById('overlay').classList.add('open'); }
function closeSheet() { document.getElementById('overlay').classList.remove('open'); }

/* --- THEME --- */
const themeBtn = document.getElementById('themeBtn');
let isDark = localStorage.getItem('theme') === 'dark';
function applyTheme() {
  document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light');
  themeBtn.innerHTML = isDark 
    ? '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>'
    : '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>';
}
themeBtn.addEventListener('click', () => {
  isDark = !isDark;
  localStorage.setItem('theme', isDark ? 'dark' : 'light');
  applyTheme();
});

// Init
applyTheme();
render();
</script>
</body>
</html>