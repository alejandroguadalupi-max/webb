<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Zona Kids | Diver-Men√∫</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&family=Outfit:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --brand-color: #FF8C00; 
      --bg-body: #f0f4f8;
      --bg-card: #ffffff;
      --text-main: #1e293b;
      --text-sec: #64748b;
      --border: #e2e8f0;
      --shadow-cartoon: 0 8px 0 rgba(0,0,0,0.08);
      --radius-fun: 28px;
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }

    body {
      margin: 0; font-family: 'Fredoka', sans-serif;
      background: var(--bg-body); color: var(--text-main);
      min-height: 100vh; display: flex; flex-direction: column;
      align-items: center; overflow-x: hidden;
    }

    header {
      width: 100%; padding: 20px; text-align: center;
      background: var(--bg-card); border-bottom: 4px solid var(--border);
      position: sticky; top: 0; z-index: 100;
    }

    h1 { margin: 0; font-size: 1.5rem; color: var(--brand-color); text-transform: uppercase; }

    /* --- HUB MENU --- */
    .hub-grid {
      display: grid; grid-template-columns: 1fr 1fr; gap: 15px;
      width: 100%; max-width: 450px; padding: 20px;
      animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .game-card {
      background: var(--bg-card); border-radius: var(--radius-fun);
      padding: 25px 10px; display: flex; flex-direction: column;
      align-items: center; cursor: pointer; border: 3px solid var(--border);
      box-shadow: var(--shadow-cartoon); transition: 0.2s;
    }
    .game-card:active { transform: translateY(6px); box-shadow: none; }
    .game-icon { font-size: 3.5rem; margin-bottom: 8px; }
    .game-title { font-weight: 700; font-size: 1.1rem; }

    /* --- CONTENEDORES --- */
    .game-wrapper {
      display: none; flex-direction: column; align-items: center;
      width: 100%; max-width: 450px; padding: 15px; flex: 1;
    }
    .game-wrapper.active { display: flex; }

    .btn {
      padding: 18px; border-radius: 22px; border: none;
      font-weight: 700; font-family: 'Fredoka'; cursor: pointer;
      font-size: 1.1rem; width: 100%; box-shadow: 0 5px 0 rgba(0,0,0,0.1);
      transition: 0.2s; display: flex; align-items: center; justify-content: center;
    }
    .btn-back { background: #cbd5e1; color: #334155; margin-top: 20px; }
    .btn-action { background: var(--brand-color); color: #fff; }
    .btn:active { transform: translateY(3px); box-shadow: none; }

    /* === EL IMPOSTOR === */
    .setup-box { background: var(--bg-card); padding: 20px; border-radius: 25px; width: 100%; border: 3px solid var(--border); text-align: center; }
    input[type="text"] {
      width: 100%; padding: 15px; border-radius: 15px; border: 3px solid var(--border);
      font-family: 'Fredoka'; font-size: 1.1rem; margin-bottom: 10px;
    }
    .player-tag {
      background: var(--brand-color); color: white; padding: 8px 15px; border-radius: 12px;
      margin: 4px; display: inline-block; font-weight: 600;
    }
    .role-card {
      background: var(--brand-color); color: white; padding: 40px 20px;
      border-radius: 25px; width: 100%; box-shadow: var(--shadow-cartoon);
    }
    .secret-box {
      background: white; color: var(--text-main); padding: 25px;
      border-radius: 20px; font-size: 2rem; font-weight: 700; margin: 20px 0; display: none;
    }

    /* === DINO RUN === */
    #dinoCanvas { 
      background: #fff; border-radius: 20px; border: 3px solid var(--border);
      width: 100%; height: 180px; touch-action: none;
    }

    /* === MEMORY === */
    .memory-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 100%; }
    .mem-card { aspect-ratio: 1; perspective: 1000px; }
    .mem-inner { position: relative; width: 100%; height: 100%; transition: transform 0.5s; transform-style: preserve-3d; }
    .mem-card.flipped .mem-inner { transform: rotateY(180deg); }
    .mem-face {
      position: absolute; width: 100%; height: 100%; border-radius: 18px;
      backface-visibility: hidden; display: flex; align-items: center; justify-content: center;
      border: 3px solid var(--border); background: white; font-size: 2.2rem;
    }
    .mem-back { transform: rotateY(180deg); border-color: var(--brand-color); }

    /* === MOLE === */
    .mole-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 100%; }
    .hole { aspect-ratio: 1; background: #e2e8f0; border-radius: 50%; position: relative; overflow: hidden; border-bottom: 6px solid #cbd5e1; }
    .mole { position: absolute; top: 100%; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 2.8rem; transition: top 0.1s; }
    .hole.up .mole { top: 0; }

    @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
  </style>
</head>
<body>

  <header>
    <h1 id="restName">RESTAURANTE</h1>
    <div style="font-size: 0.9rem; color: var(--text-sec);">ZONA KIDS üéÆ</div>
  </header>

  <div class="hub-grid" id="hubMenu">
    <div class="game-card" onclick="openGame('memory')">
      <div class="game-icon">üß©</div>
      <div class="game-title">Parejas</div>
    </div>
    <div class="game-card" onclick="openGame('mole')">
      <div class="game-icon">üî®</div>
      <div class="game-title">Caza Chef</div>
    </div>
    <div class="game-card" onclick="openGame('impostor')">
      <div class="game-icon">ü§´</div>
      <div class="game-title">Impostor</div>
    </div>
    <div class="game-card" onclick="openGame('dino')">
      <div class="game-icon">ü¶ñ</div>
      <div class="game-title">Dino Run</div>
    </div>
    <button class="btn btn-back" style="grid-column: span 2" onclick="history.back()">‚¨Ö Salir</button>
  </div>

  <div class="game-wrapper" id="game-impostor">
    <div id="imp-setup" class="setup-box">
      <p style="font-weight:700;">¬°Escribid vuestros nombres!</p>
      <input type="text" id="pNameInput" placeholder="Nombre...">
      <button class="btn btn-action" onclick="addP()">A√±adir Jugador +</button>
      <div id="pList" style="margin: 15px 0;"></div>
      <button class="btn btn-action" id="startImpBtn" style="background:#22c55e" disabled onclick="startImp()">¬°Empezar Partida!</button>
    </div>

    <div id="imp-reveal" class="role-card" style="display:none;">
      <h2 id="turnLabel">Turno de...</h2>
      <div id="sBox" class="secret-box">PALABRA</div>
      <button class="btn btn-action" id="revBtn" style="background:white; color:var(--brand-color);" onclick="handleImp()">VER PALABRA</button>
    </div>

    <div id="imp-playing" class="setup-box" style="display:none;">
      <h2 style="color:var(--brand-color);">¬°RONDA DE PISTAS!</h2>
      <p id="starterLabel" style="font-size:1.3rem; font-weight:700;"></p>
      <p style="font-size:0.9rem; color:var(--text-sec);">No digas la palabra exacta. El impostor intentar√° camuflarse.</p>
      <button class="btn btn-action" style="margin-top:20px; background:#ef4444" onclick="finishImp()">REVELAR IMPOSTOR</button>
    </div>

    <div id="imp-result" class="setup-box" style="display:none;">
      <p>El impostor era...</p>
      <h1 id="impNameResult" style="font-size:3rem; color:var(--brand-color);">---</h1>
      <button class="btn btn-action" onclick="location.reload()">Jugar de Nuevo</button>
    </div>
    <button class="btn btn-back" onclick="location.reload()">Salir</button>
  </div>

  <div class="game-wrapper" id="game-dino">
    <div style="font-size:1.3rem; font-weight:800; margin-bottom:10px;">Puntos: <span id="dinoScore">0</span></div>
    <canvas id="dinoCanvas"></canvas>
    <button class="btn btn-action" style="margin-top:20px; height:90px; font-size:1.5rem;" onmousedown="dinoJump()" ontouchstart="dinoJump()">¬°SALTAR! üëÜ</button>
    <button class="btn btn-back" onclick="location.reload()">Salir</button>
  </div>

  <div class="game-wrapper" id="game-memory"><div class="memory-grid" id="mBoard"></div><button class="btn btn-back" onclick="location.reload()">Salir</button></div>
  <div class="game-wrapper" id="game-mole">
    <div style="font-size:1.5rem; font-weight:800; margin-bottom:10px;">Caza: <span id="moScore">0</span></div>
    <div class="mole-grid" id="moGrid"></div>
    <button class="btn btn-back" onclick="location.reload()">Salir</button>
  </div>

  <script>
    const params = new URLSearchParams(window.location.search);
    document.getElementById('restName').innerText = params.get('n') || "DIVER-MEN√ö";
    const brandColor = params.get('btn') ? '#' + params.get('btn') : '#FF8C00';
    document.documentElement.style.setProperty('--brand-color', brandColor);

    function openGame(id) {
      document.getElementById('hubMenu').style.display = 'none';
      document.querySelectorAll('.game-wrapper').forEach(w => w.classList.remove('active'));
      document.getElementById(`game-${id}`).classList.add('active');
      window[`init_${id}`]();
    }

    /* EL IMPOSTOR */
    let players = [], impIdx = -1, revIdx = 0, isVis = false, sWord = "";
    const words = ["Pizza", "Hamburguesa", "Sushi", "Taco", "Pasta", "Helado", "Sopa", "Ensalada", "Bistec"];
    
    function addP() {
      const input = document.getElementById('pNameInput');
      if(input.value.trim() && players.length < 10) {
        players.push(input.value.trim());
        input.value = "";
        document.getElementById('pList').innerHTML = players.map(p => `<span class="player-tag">${p}</span>`).join('');
      }
      document.getElementById('startImpBtn').disabled = players.length < 3;
    }

    function startImp() {
      impIdx = Math.floor(Math.random() * players.length);
      sWord = words[Math.floor(Math.random() * words.length)];
      document.getElementById('imp-setup').style.display = "none";
      document.getElementById('imp-reveal').style.display = "block";
      updateRevUI();
    }

    function updateRevUI() {
      isVis = false;
      document.getElementById('turnLabel').innerText = `Pasa el m√≥vil a: ${players[revIdx]}`;
      document.getElementById('sBox').style.display = "none";
      document.getElementById('revBtn').innerText = "VER MI PALABRA";
    }

    function handleImp() {
      const box = document.getElementById('sBox');
      const btn = document.getElementById('revBtn');
      if(!isVis) {
        box.style.display = "block";
        box.innerText = (revIdx === impIdx) ? "ERES EL IMPOSTOR üòà" : `Palabra: ${sWord}`;
        btn.innerText = "ENTENDIDO (Ocultar)";
        isVis = true;
      } else {
        revIdx++;
        if(revIdx < players.length) updateRevUI();
        else {
          document.getElementById('imp-reveal').style.display = "none";
          document.getElementById('imp-playing').style.display = "block";
          document.getElementById('starterLabel').innerText = "Empieza: " + players[Math.floor(Math.random()*players.length)];
        }
      }
    }
    function finishImp() {
      document.getElementById('imp-playing').style.display = "none";
      document.getElementById('imp-result').style.display = "block";
      document.getElementById('impNameResult').innerText = players[impIdx];
    }

    /* DINO RUN (Dinosaurio mirando al frente) */
    let canvas, ctx, dino, obstacles = [], frame = 0, dScore = 0, dActive = false;
    function init_dino() {
      canvas = document.getElementById('dinoCanvas');
      ctx = canvas.getContext('2d');
      canvas.width = 400; canvas.height = 200;
      dino = { x: 50, y: 140, w: 45, h: 45, dy: 0, jump: -12, gravity: 0.6, grounded: true };
      obstacles = []; dScore = 0; dActive = true;
      requestAnimationFrame(dinoLoop);
    }
    function dinoJump() { if(dino.grounded) { dino.dy = dino.jump; dino.grounded = false; } }
    function dinoLoop() {
      if(!dActive) return;
      ctx.clearRect(0,0,400,200);
      
      // Suelo
      ctx.strokeStyle = "#e2e8f0";
      ctx.beginPath(); ctx.moveTo(0,185); ctx.lineTo(400,185); ctx.stroke();

      // Dinosaurio mirando a la derecha (espejo del emoji original)
      dino.dy += dino.gravity; dino.y += dino.dy;
      if(dino.y > 140) { dino.y = 140; dino.dy = 0; dino.grounded = true; }
      
      ctx.save();
      ctx.translate(dino.x + 22, dino.y + 22);
      ctx.scale(-1, 1); // Volteamos el emoji para que mire al frente (derecha)
      ctx.font = "40px Arial";
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.fillText("ü¶ñ", 0, 0);
      ctx.restore();

      // Obst√°culos
      if(frame % 90 === 0) obstacles.push({ x: 400, y: 145 });
      obstacles.forEach((o, i) => {
        o.x -= 6;
        ctx.font = "30px Arial";
        ctx.fillText("üåµ", o.x, o.y + 30);
        if(o.x < dino.x + 30 && o.x + 30 > dino.x && o.y < dino.y + 35 && o.y + 35 > dino.y) {
           dActive = false; alert("¬°Game Over! Puntos: " + dScore); location.reload();
        }
        if(o.x < -50) { obstacles.splice(i, 1); dScore++; document.getElementById('dinoScore').innerText = dScore; }
      });
      frame++; requestAnimationFrame(dinoLoop);
    }

    /* OTROS JUEGOS */
    function init_memory() {
      const icons = ['üçï','üçü','üç¶','üç©','üçé','üçì'];
      const deck = [...icons, ...icons].sort(() => Math.random() - 0.5);
      const board = document.getElementById('mBoard');
      board.innerHTML = deck.map(i => `<div class="mem-card" onclick="flip(this)"><div class="mem-inner"><div class="mem-face mem-front">?</div><div class="mem-face mem-back">${i}</div></div></div>`).join('');
    }
    let flipped = [];
    function flip(c) {
      if(flipped.length < 2 && !c.classList.contains('flipped')) {
        c.classList.add('flipped'); flipped.push(c);
        if(flipped.length === 2) {
          if(flipped[0].innerText === flipped[1].innerText) flipped = [];
          else setTimeout(() => { flipped.forEach(x => x.classList.remove('flipped')); flipped = []; }, 800);
        }
      }
    }
    function init_mole() {
      let s = 0; document.getElementById('moGrid').innerHTML = Array(9).fill('<div class="hole"><div class="mole" onclick="h(this)">üë®‚Äçüç≥</div></div>').join('');
      const t = setInterval(() => {
        const h = document.querySelectorAll('.hole');
        const r = h[Math.floor(Math.random()*9)];
        r.classList.add('up'); setTimeout(() => r.classList.remove('up'), 700);
      }, 900);
      setTimeout(() => { clearInterval(t); alert("Puntos: " + s); location.reload(); }, 15000);
      window.h = (e) => { e.parentNode.classList.remove('up'); s++; document.getElementById('moScore').innerText = s; if(navigator.vibrate) navigator.vibrate(40); };
    }
  </script>
</body>
</html>