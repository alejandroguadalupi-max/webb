<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Minijuegos - PataMig</title>
<style>
  /* Reset y estilo bÃ¡sico */
  body {
    margin: 0;
    font-family: 'Arial', sans-serif;
    background: #f5f5f5;
    color: #333;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  h1 {
    margin-top: 20px;
    color: #4a8f3d;
    font-size: 2em;
  }

  /* Menu de selecciÃ³n de juegos */
  .game-menu {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 15px;
    margin: 20px 0;
  }

  .game-card {
    width: 120px;
    cursor: pointer;
    border-radius: 15px;
    overflow: hidden;
    background: #fff;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    transition: transform 0.3s, box-shadow 0.3s;
    text-align: center;
  }

  .game-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.3);
  }

  .game-card img {
    width: 100%;
    display: block;
  }

  .game-card span {
    display: block;
    padding: 8px 0;
    font-weight: bold;
    color: #333;
  }

  /* Contenedor del juego */
  .game-container {
    width: 90%;
    max-width: 400px;
    height: 400px;
    background: #000;
    border-radius: 15px;
    border: 4px solid #4a8f3d;
    position: relative;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  canvas {
    display: block;
    background: #000;
    border-radius: 15px;
  }

  #score {
    margin-top: 10px;
    font-size: 1.2em;
    color: #4a8f3d;
    font-weight: bold;
  }

  @media (max-width: 500px){
    .game-card { width: 100px; }
    .game-container { height: 300px; }
  }
</style>
</head>
<body>
<a href = "principal.html">Ir a inicio</a>
<h1>ðŸŽ® Minijuegos PataMig</h1>

<div class="game-menu">
  <div class="game-card" onclick="selectGame('tetris')">
    <img src="https://i.imgur.com/T6XjD1r.png" alt="Tetris">
    <span>Tetris</span>
  </div>
  <div class="game-card" onclick="selectGame('snake')">
    <img src="https://i.imgur.com/KP0Xhvw.png" alt="Snake">
    <span>Snake</span>
  </div>
  <div class="game-card" onclick="selectGame('whack')">
    <img src="https://i.imgur.com/0Yljmce.png" alt="Whack-a-Mole">
    <span>Whack-a-Mole</span>
  </div>
</div>

<div class="game-container">
  <canvas id="gameCanvas"></canvas>
</div>
<div id="score"></div>

<script>
// ---------------------- CONTEXTO ----------------------
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = 400;
canvas.height = 400;
const scoreDisplay = document.getElementById('score');
let intervalId = null;

// ---------------------- SELECCIÃ“N DE JUEGO ----------------------
function selectGame(game){
  clearInterval(intervalId);
  ctx.clearRect(0,0,canvas.width,canvas.height);
  scoreDisplay.textContent = '';
  document.querySelectorAll('.game-card').forEach(c=>c.classList.remove('active'));
  
  if(game==='tetris') startTetris();
  else if(game==='snake') startSnake();
  else if(game==='whack') startWhack();
}

// ---------------------- TETRIS ----------------------
function startTetris(){
  const COLS=10, ROWS=20, BLOCK=canvas.width/COLS;
  let grid = Array.from({length:ROWS},()=>Array(COLS).fill(0));
  let piece = {x:4, y:0, shape:[[1,1,1],[0,1,0]]};
  let score=0;

  function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    for(let r=0;r<ROWS;r++){
      for(let c=0;c<COLS;c++){
        ctx.fillStyle = grid[r][c] ? '#92d668' : '#111';
        ctx.fillRect(c*BLOCK, r*BLOCK, BLOCK-1, BLOCK-1);
      }
    }
    ctx.fillStyle = '#f4e842';
    piece.shape.forEach((row,i)=>{
      row.forEach((val,j)=>{
        if(val) ctx.fillRect((piece.x+j)*BLOCK, (piece.y+i)*BLOCK, BLOCK-1, BLOCK-1);
      });
    });
  }

  function moveDown(){
    piece.y++;
    if(collision()){ piece.y--; merge(); newPiece(); clearLines(); }
    draw();
  }

  function collision(){
    for(let i=0;i<piece.shape.length;i++){
      for(let j=0;j<piece.shape[i].length;j++){
        if(piece.shape[i][j]){
          if(piece.y+i>=ROWS || piece.x+j<0 || piece.x+j>=COLS || grid[piece.y+i][piece.x+j]) return true;
        }
      }
    }
    return false;
  }

  function merge(){
    for(let i=0;i<piece.shape.length;i++){
      for(let j=0;j<piece.shape[i].length;j++){
        if(piece.shape[i][j]) grid[piece.y+i][piece.x+j]=1;
      }
    }
  }

  function newPiece(){ piece = {x:4, y:0, shape:[[1,1,1],[0,1,0]]}; }

  function clearLines(){
    for(let r=ROWS-1;r>=0;r--){
      if(grid[r].every(v=>v)){
        grid.splice(r,1); grid.unshift(Array(COLS).fill(0));
        score+=10; scoreDisplay.textContent='Puntos: '+score;
        r++;
      }
    }
  }

  document.onkeydown = e=>{
    if(e.key==='ArrowLeft'){ piece.x--; if(collision()) piece.x++; }
    if(e.key==='ArrowRight'){ piece.x++; if(collision()) piece.x--; }
    if(e.key==='ArrowDown'){ moveDown(); }
    if(e.key==='ArrowUp'){
      piece.shape = piece.shape[0].map((_,i)=>piece.shape.map(r=>r[i]).reverse());
      if(collision()) piece.shape = piece.shape[0].map((_,i)=>piece.shape.map(r=>r[i]).reverse());
    }
    draw();
  }

  intervalId = setInterval(moveDown,400);
}

// ---------------------- SNAKE ----------------------
function startSnake(){
  const SIZE=20, COLS=canvas.width/SIZE, ROWS=canvas.height/SIZE;
  let snake=[{x:5,y:5}], dx=1, dy=0, apple={x:10,y:10}, score=0;

  function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle='#92d668';
    snake.forEach(s=>ctx.fillRect(s.x*SIZE,s.y*SIZE,SIZE-1,SIZE-1));
    ctx.fillStyle='#f4e842';
    ctx.fillRect(apple.x*SIZE, apple.y*SIZE, SIZE-1, SIZE-1);
  }

  function update(){
    const head={x:snake[0].x+dx, y:snake[0].y+dy};
    if(head.x<0||head.x>=COLS||head.y<0||head.y>=ROWS||snake.some(s=>s.x===head.x && s.y===head.y)){
      clearInterval(intervalId);
      alert('Game Over!');
      return;
    }
    snake.unshift(head);
    if(head.x===apple.x && head.y===apple.y){
      score++; scoreDisplay.textContent='Puntos: '+score;
      apple={x:Math.floor(Math.random()*COLS),y:Math.floor(Math.random()*ROWS)};
    } else snake.pop();
    draw();
  }

  document.onkeydown=e=>{
    if(e.key==='ArrowLeft'){dx=-1;dy=0;}
    if(e.key==='ArrowRight'){dx=1;dy=0;}
    if(e.key==='ArrowUp'){dx=0;dy=-1;}
    if(e.key==='ArrowDown'){dx=0;dy=1;}
  }

  intervalId = setInterval(update,150);
}

// ---------------------- WHACK-A-MOLE ----------------------
function startWhack(){
  const SIZE=80; // topitos mÃ¡s grandes
  let score=0;
  scoreDisplay.textContent='Puntos: '+score;
  const moles = [];
  for(let i=0;i<16;i++){
    const mole=document.createElement('div');
    mole.style.width=SIZE+'px';
    mole.style.height=SIZE+'px';
    mole.style.background='#92d668';
    mole.style.position='absolute';
    mole.style.display='none';
    mole.style.borderRadius='50%';
    canvas.parentElement.appendChild(mole);
    moles.push(mole);
  }

  function spawnMole(){
    moles.forEach(m=>m.style.display='none');
    const idx=Math.floor(Math.random()*moles.length);
    moles[idx].style.display='block';
    moles[idx].style.left=(idx%4)*SIZE+'px';
    moles[idx].style.top=Math.floor(idx/4)*SIZE+'px';
  }

  moles.forEach(m=>{
    m.onclick=()=>{
      score++; scoreDisplay.textContent='Puntos: '+score;
      spawnMole();
    }
  });

  spawnMole();
  intervalId=setInterval(spawnMole,1000);
}
</script>

</body>
</html>
