<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="theme-color" content="#0b0f18">
<title>¬øC√≥mo fue tu experiencia?</title>
<style>
  :root{
    --text:#0b0f18; --muted:#566073;
    --brand:#0b0f18; --ok:#16a34a; --accent:#2563eb;
    --card:#ffffff; --bg:#f7f7fb; --border:#e6e8ee;
  }

  * { box-sizing: border-box; }
  html,body{ height:100%; margin:0; font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial; color:var(--text); background:var(--bg); }

  /* Layout centrado y tarjeta full-height pero compacta */
  body{
    display:flex; align-items:center; justify-content:center;
    padding:20px;
    background:
      radial-gradient(900px 600px at 8% -10%, #f1f5ff 0, #fff 50%) no-repeat,
      var(--bg);
  }

  .shell{
    width:min(980px,100%);
    max-width:980px;
    height:calc(100vh - 40px);
    display:grid;
    grid-template-columns: 1fr min(640px,100%);
    gap:20px;
    align-items:center;
    justify-items:center;
  }

  /* banditas laterales decorativas */
  .side-deco{
    width:100%;
    height:100%;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .bar {
    width:28px;
    height:60%;
    border-radius:18px;
    background:linear-gradient(180deg, rgba(37,99,235,0.12), rgba(37,99,235,0.02));
    box-shadow:0 6px 24px rgba(37,99,235,0.06) inset;
  }

  /* tarjeta principal */
  .card{
    width:100%;
    max-width:640px;
    height:100%;
    background:var(--card);
    border-radius:18px;
    border:1px solid var(--border);
    padding:22px;
    display:flex;
    flex-direction:column;
    gap:12px;
    overflow:hidden;
  }

  /* idioma */
  #lang-selector{position:absolute; top:18px; right:22px; z-index:10;}
  #current-lang{
    cursor:pointer; font-size:20px; padding:6px; border-radius:8px;
    background:rgba(0,0,0,.04); display:inline-grid; place-items:center;
  }
  #lang-options{ display:none; position:absolute; right:0; top:calc(100% + 6px);
    background:var(--card); border:1px solid var(--border); border-radius:10px; padding:6px; box-shadow:0 8px 20px rgba(12,20,33,.08);
  }
  .lang-option{ padding:8px 10px; cursor:pointer; border-radius:8px; font-weight:700; color:var(--muted)}
  .lang-option:hover{ background:var(--bg); }

  /* header */
  .brand{ display:flex; align-items:center; gap:12px; padding-bottom:4px; }
  .logo{ width:56px; height:56px; border-radius:12px; overflow:hidden; display:grid; place-items:center; background:#fff; box-shadow:0 6px 18px rgba(12,20,33,0.06); }
  .logo img{ width:100%; height:100%; object-fit:cover; }
  .brand h1{ margin:0; font-size:18px; font-weight:800; }
  .brand p{ margin:0; color:var(--muted); font-size:13px; }

  /* grid botones (rese√±a/private) */
  .grid{ display:grid; grid-template-columns:1fr 1fr; gap:12px; width:100%; }
  .tile{ border-radius:12px; padding:10px; border:1px solid var(--border); background:#fff; display:flex; flex-direction:column; gap:8px; align-items:center; }
  .tile h2{ margin:0; font-size:15px; }
  .tile p{ margin:0; font-size:13px; color:var(--muted); text-align:center; }

  .btn{ display:inline-flex; align-items:center; justify-content:center; gap:8px; padding:10px 12px; border-radius:10px; font-weight:800; text-decoration:none; color:#fff; border:0; cursor:pointer; }
  .btn:active{ transform:translateY(1px); }
  .btn-google{ background:linear-gradient(180deg,#6baeff,var(--accent)); min-width:170px; }
  .btn-private{ background:linear-gradient(180deg,#4ade80,var(--ok)); min-width:170px; color:#063; }
  .btn-ghost{ background:transparent; border:1px dashed var(--border); color:var(--muted); padding:8px 10px; border-radius:8px; font-weight:700; }

  /* compartir compacto */
  .share-row{ display:flex; gap:10px; align-items:center; justify-content:space-between; padding:10px; border-radius:12px; border:1px solid var(--border); background:linear-gradient(180deg,#fff,#fbfdff); }
  .share-left{ display:flex; gap:10px; align-items:center; min-width:0; }
  .share-meta{ display:flex; flex-direction:column; gap:4px; min-width:0; }
  .share-title{ font-size:14px; font-weight:700; margin:0; }
  .share-sub{ font-size:12px; color:var(--muted); margin:0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
  .share-actions{ display:flex; gap:8px; align-items:center; }

  /* preview */
  .preview{
    width:84px; height:64px; border-radius:10px; overflow:hidden; display:grid; place-items:center; background:linear-gradient(180deg,#f8fafc,#ffffff); border:1px solid var(--border);
  }
  .preview img{ width:100%; height:100%; object-fit:cover; }

  .small-note{ font-size:12px; color:var(--muted); }

  /* compact footer space */
  .foot-space{ margin-top:auto; font-size:12px; color:var(--muted); text-align:center; padding-top:6px; }

  @media(max-width:720px){
    .shell{ grid-template-columns: 1fr; padding:10px; }
    .side-deco{ display:none; }
    .grid{ grid-template-columns:1fr; }
  }
</style>
</head>
<body>
  <div class="shell" aria-hidden="false">
    <div class="side-deco" aria-hidden="true">
      <div class="bar"></div>
    </div>

    <div style="position:relative; width:100%; display:flex; justify-content:center;">
      <div class="card" role="main" aria-labelledby="title">

        <!-- idioma -->
        <div id="lang-selector" aria-hidden="false">
          <div id="current-lang" title="Cambiar idioma">üá™üá∏</div>
          <div id="lang-options" role="menu" aria-hidden="true"></div>
        </div>

        <header class="brand" role="banner">
          <div class="logo"><img src="img/imagen_circular_recortada.png" alt="Logo Casablanca"></div>
          <div>
            <h1 id="title">Restaurante Casablanca</h1>
            <p id="subtitle">Cu√©ntanos en 10 segundos c√≥mo fue todo.</p>
          </div>
        </header>

        <div class="grid" role="region" aria-label="Opciones">
          <div class="tile" aria-labelledby="publicTitle">
            <h2 id="publicTitle">‚≠ê Rese√±a p√∫blica</h2>
            <p id="publicText">Si te fue bien, tu rese√±a nos da visibilidad en Google.</p>
            <a id="btnGoogle" class="btn btn-google" target="_blank" rel="noopener">Dejar rese√±a en Google</a>
            <div class="small-note" id="publicNote">Queda visible para todos.</div>
          </div>

          <div class="tile" aria-labelledby="privateTitle">
            <h2 id="privateTitle">üìù Comentario privado</h2>
            <p id="privateText">Si algo fall√≥, cu√©ntanos y lo arreglamos contigo.</p>
            <a id="btnPrivate" class="btn btn-private" target="_blank" rel="noopener">Enviar comentario privado</a>
            <div class="small-note" id="privateNote">Solo lo vemos nosotros.</div>
          </div>
        </div>

        <!-- secci√≥n compartir compacta -->
        <div class="share-row" aria-labelledby="shareTitle" style="margin-top:6px;">
          <div class="share-left">
            <div class="preview" id="previewBox" aria-hidden="true"><span style="font-size:12px;color:var(--muted)">Sin foto</span></div>
            <div class="share-meta">
              <p id="shareTitle" class="share-title">üì∏ Comparte tu experiencia</p>
              <p id="shareText" class="share-sub">Saca o elige una foto y comparte con tus amigos.</p>
              <div style="display:flex;gap:8px;">
                <button id="btnCamera" class="btn-ghost" title="Sacar foto">üì∑ Sacar</button>
                <button id="btnGallery" class="btn-ghost" title="Elegir de galer√≠a">üñºÔ∏è Galer√≠a</button>
                <button id="btnRetake" class="btn-ghost" title="Cambiar foto" style="display:none;">üîÅ Repetir</button>
              </div>
            </div>
          </div>

          <div class="share-actions">
            <button id="btnShare" class="btn btn-google" title="Compartir">Compartir</button>
          </div>
        </div>

        <div class="foot-space" id="hint">Primero elige o toma una foto. Despu√©s podr√°s compartirla junto al mensaje y la ubicaci√≥n.</div>
      </div>
    </div>

    <div class="side-deco" aria-hidden="true">
      <div class="bar" style="transform:scaleX(-1)"></div>
    </div>
  </div>

  <!-- inputs ocultos para c√°mara y galer√≠a -->
  <input id="cameraInput" type="file" accept="image/*" capture="environment" style="display:none" aria-hidden="true">
  <input id="galleryInput" type="file" accept="image/*" style="display:none" aria-hidden="true">

<script>
/* CONFIG */
const RESTAURANT_NAME = "Terraza Casablanca Las Canteras";
const GOOGLE_MAPS_SHORT = "https://maps.app.goo.gl/CasablancaLasCanteras";

/* MULTILING√úE (completo para UI que vemos) */
const COPY = {
  es: {
    pageTitle: "¬øC√≥mo fue tu experiencia?",
    subtitle: "Cu√©ntanos en 10 segundos c√≥mo fue todo.",
    publicTitle: "‚≠ê Rese√±a p√∫blica",
    publicText: "Si te fue bien, tu rese√±a nos da visibilidad en Google.",
    publicBtn: "Dejar rese√±a en Google",
    publicNote: "Queda visible para todos.",
    privateTitle: "üìù Comentario privado",
    privateText: "Si algo fall√≥, cu√©ntanos y lo arreglamos contigo.",
    privateBtn: "Enviar comentario privado",
    privateNote: "Solo lo vemos nosotros.",
    shareTitle: "üì∏ Comparte tu experiencia",
    shareText: "Saca o elige una foto y comparte con tus amigos.",
    shareHint: "Primero elige o toma una foto. Despu√©s podr√°s compartirla junto al mensaje y la ubicaci√≥n.",
    shareBtn: "Compartir",
    shareMsg: "¬°Acabo de disfrutar en " + RESTAURANT_NAME + " üç∏‚ú® ‚Äî ven a verlo!",
    chooseCamera: "üì∑ Sacar",
    chooseGallery: "üñºÔ∏è Galer√≠a",
    retake: "üîÅ Repetir",
    sharedOK: "‚úÖ ¬°Compartido!",
    copiedOK: "‚úÖ Copiado al portapapeles"
  },
  en: {
    pageTitle: "How was your experience?",
    subtitle: "Tell us in 10 seconds how everything went.",
    publicTitle: "‚≠ê Public review",
    publicText: "If things went well, your review helps us on Google.",
    publicBtn: "Leave a Google review",
    publicNote: "Visible to everyone.",
    privateTitle: "üìù Private feedback",
    privateText: "If something went wrong, tell us and we‚Äôll fix it.",
    privateBtn: "Send private feedback",
    privateNote: "Only we can see it.",
    shareTitle: "üì∏ Share your experience",
    shareText: "Take or choose a photo and share with friends.",
    shareHint: "First take or choose a photo. Then you can share it with the message and location.",
    shareBtn: "Share",
    shareMsg: "I just enjoyed " + RESTAURANT_NAME + " üç∏‚ú® ‚Äî you should come!",
    chooseCamera: "üì∑ Take",
    chooseGallery: "üñºÔ∏è Gallery",
    retake: "üîÅ Retake",
    sharedOK: "‚úÖ Shared!",
    copiedOK: "‚úÖ Copied to clipboard"
  },
  de: {
    pageTitle: "Wie war Ihre Erfahrung?",
    subtitle: "Erz√§hlen Sie uns in 10 Sekunden, wie alles war.",
    publicTitle: "‚≠ê √ñffentliche Bewertung",
    publicText: "Wenn es Ihnen gefallen hat, hilft uns Ihre Bewertung bei Google.",
    publicBtn: "Google-Bewertung abgeben",
    publicNote: "F√ºr alle sichtbar.",
    privateTitle: "üìù Privater Kommentar",
    privateText: "Wenn etwas schief gelaufen ist, sagen Sie es uns und wir kl√§ren es.",
    privateBtn: "Privaten Kommentar senden",
    privateNote: "Nur wir sehen es.",
    shareTitle: "üì∏ Teile deine Erfahrung",
    shareText: "Mach ein Foto oder w√§hle eins und teile es mit Freunden.",
    shareHint: "Zuerst Foto aufnehmen oder ausw√§hlen. Danach kannst du es mit Nachricht und Ort teilen.",
    shareBtn: "Teilen",
    shareMsg: "Ich habe gerade " + RESTAURANT_NAME + " genossen üç∏‚ú® ‚Äî sehr empfehlenswert!",
    chooseCamera: "üì∑ Foto",
    chooseGallery: "üñºÔ∏è Galerie",
    retake: "üîÅ Neu",
    sharedOK: "‚úÖ Geteilt!",
    copiedOK: "‚úÖ In Zwischenablage kopiert"
  },
  fr: {
    pageTitle: "Comment √©tait votre exp√©rience ?",
    subtitle: "Racontez-nous en 10 secondes comment tout s'est pass√©.",
    publicTitle: "‚≠ê Avis public",
    publicText: "Si tout s'est bien pass√©, votre avis nous aide sur Google.",
    publicBtn: "Laisser un avis Google",
    publicNote: "Visible par tout le monde.",
    privateTitle: "üìù Commentaire priv√©",
    privateText: "Si quelque chose n'allait pas, dites-le nous et nous le corrigerons.",
    privateBtn: "Envoyer un commentaire priv√©",
    privateNote: "Seulement nous le voyons.",
    shareTitle: "üì∏ Partage ton exp√©rience",
    shareText: "Prends ou choisis une photo et partage-la avec tes amis.",
    shareHint: "D'abord prends ou choisis une photo. Ensuite tu peux la partager avec message et localisation.",
    shareBtn: "Partager",
    shareMsg: "Je viens de profiter de " + RESTAURANT_NAME + " üç∏‚ú® ‚Äî √† ne pas manquer !",
    chooseCamera: "üì∑ Prendre",
    chooseGallery: "üñºÔ∏è Galerie",
    retake: "üîÅ Refaire",
    sharedOK: "‚úÖ Partag√©!",
    copiedOK: "‚úÖ Copi√©"
  }
};

/* ELEMENTOS */
const cameraInput = document.getElementById('cameraInput');
const galleryInput = document.getElementById('galleryInput');
const btnCamera = document.getElementById('btnCamera');
const btnGallery = document.getElementById('btnGallery');
const btnRetake = document.getElementById('btnRetake');
const previewBox = document.getElementById('previewBox');
const btnShare = document.getElementById('btnShare');
const hint = document.getElementById('hint');

const btnGoogle = document.getElementById('btnGoogle');
const btnPrivate = document.getElementById('btnPrivate');
const publicNote = document.getElementById('publicNote');
const privateNote = document.getElementById('privateNote');

const langSelector = document.getElementById('lang-selector');
const currentLangFlag = document.getElementById('current-lang');
const langOptions = document.getElementById('lang-options');

/* idioma inicial */
const LANGS = ['es','en','de','fr'];
function getInitialLang(){
  const saved = localStorage.getItem('userLang');
  if(saved && LANGS.includes(saved)) return saved;
  const bl = (navigator.languages || [navigator.language || 'en']).map(l=>l.slice(0,2));
  for(const b of bl) if(LANGS.includes(b)) return b;
  return 'es';
}
let currentLang = getInitialLang();

/* rellenar selector idiomas */
function buildLangOptions(){
  langOptions.innerHTML = '';
  LANGS.forEach(code=>{
    const div = document.createElement('div');
    div.className = 'lang-option';
    const flag = ({es:'üá™üá∏',en:'üá¨üáß',de:'üá©üá™',fr:'üá´üá∑'})[code];
    div.textContent = flag + ' ' + code.toUpperCase();
    div.addEventListener('click', ()=>setLang(code));
    langOptions.appendChild(div);
  });
  currentLangFlag.textContent = ({es:'üá™üá∏',en:'üá¨üáß',de:'üá©üá™',fr:'üá´üá∑'})[currentLang];
}
currentLangFlag.addEventListener('click', (e)=> { e.stopPropagation(); langOptions.style.display = langOptions.style.display==='block'?'none':'block'; });
document.addEventListener('click', (e)=>{ if(!langSelector.contains(e.target)) langOptions.style.display='none'; });

/* aplicar idioma */
function setLang(code){
  currentLang = code;
  localStorage.setItem('userLang', code);
  const dict = COPY[code];
  document.title = dict.pageTitle;
  document.getElementById('subtitle').textContent = dict.subtitle;
  document.getElementById('publicTitle').textContent = dict.publicTitle;
  document.getElementById('publicText').textContent = dict.publicText;
  btnGoogle.textContent = dict.publicBtn;
  publicNote.textContent = dict.publicNote;
  document.getElementById('privateTitle').textContent = dict.privateTitle;
  document.getElementById('privateText').textContent = dict.privateText;
  btnPrivate.textContent = dict.privateBtn;
  privateNote.textContent = dict.privateNote;
  document.getElementById('shareTitle').textContent = dict.shareTitle;
  document.getElementById('shareText').textContent = dict.shareText;
  hint.textContent = dict.shareHint;
  btnCamera.textContent = dict.chooseCamera;
  btnGallery.textContent = dict.chooseGallery;
  btnRetake.textContent = dict.retake;
  btnShare.textContent = dict.shareBtn;
  currentLangFlag.textContent = ({es:'üá™üá∏',en:'üá¨üáß',de:'üá©üá™',fr:'üá´üá∑'})[code];
  langOptions.style.display = 'none';
}

/* carga inicial idioma y selector */
buildLangOptions();
setLang(currentLang);

/* Helpers preview */
function showPreview(file){
  const url = URL.createObjectURL(file);
  previewBox.innerHTML = '';
  const img = document.createElement('img');
  img.src = url;
  img.onload = ()=> URL.revokeObjectURL(url);
  previewBox.appendChild(img);
  previewBox.setAttribute('aria-hidden','false');
}

/* reset photo */
function clearPreview(){
  previewBox.innerHTML = '<span style="font-size:12px;color:var(--muted)">Sin foto</span>';
  previewBox.setAttribute('aria-hidden','true');
  btnRetake.style.display = 'none';
}

/* gesti√≥n inputs y botones */
let currentFile = null;
btnCamera.addEventListener('click', ()=> cameraInput.click());
btnGallery.addEventListener('click', ()=> galleryInput.click());
btnRetake.addEventListener('click', ()=>{
  cameraInput.value = '';
  galleryInput.value = '';
  currentFile = null;
  clearPreview();
  hint.textContent = COPY[currentLang].shareHint;
});

cameraInput.addEventListener('change', async (e)=>{
  if(e.target.files && e.target.files[0]){
    currentFile = e.target.files[0];
    showPreview(currentFile);
    btnRetake.style.display = 'inline-block';
    hint.textContent = '‚úÖ ' + (COPY[currentLang].shareBtn) + ' para enviar o pulsa üîÅ para repetir';
    // Auto-open share if supported:
    setTimeout(()=> tryAutoShare(), 450);
  }
});
galleryInput.addEventListener('change', async (e)=>{
  if(e.target.files && e.target.files[0]){
    currentFile = e.target.files[0];
    showPreview(currentFile);
    btnRetake.style.display = 'inline-block';
    hint.textContent = '‚úÖ ' + (COPY[currentLang].shareBtn) + ' para enviar o pulsa üîÅ para repetir';
    // Auto-open share if supported:
    setTimeout(()=> tryAutoShare(), 450);
  }
});

/* intento de compartir autom√°tico para flujo m√°s inmediato.
   Si falla (usuario cancela) deja la UI para compartir manualmente. */
async function tryAutoShare(){
  if(!currentFile) return;
  const dict = COPY[currentLang];
  const text = dict.shareMsg + "\nüìç " + RESTAURANT_NAME + "\n" + GOOGLE_MAPS_SHORT;
  if(navigator.share && navigator.canShare && navigator.canShare({files:[currentFile]})){
    try{
      await navigator.share({ files: [currentFile], text });
      hint.textContent = dict.sharedOK;
      // limpiar preview despu√©s de compartir
      setTimeout(()=>{ currentFile=null; clearPreview(); }, 800);
    }catch(err){
      // usuario cancel√≥; dejamos la vista para compartir manual
      console.log('Auto-share cancelado o fallido', err);
    }
  }
}

/* bot√≥n compartir manual */
btnShare.addEventListener('click', async (e)=>{
  e.preventDefault();
  const dict = COPY[currentLang];
  const text = dict.shareMsg + "\nüìç " + RESTAURANT_NAME + "\n" + GOOGLE_MAPS_SHORT;
  try{
    if(currentFile && navigator.canShare && navigator.canShare({ files:[currentFile] }) && navigator.share){
      await navigator.share({ files:[currentFile], text });
      hint.textContent = dict.sharedOK;
      currentFile = null;
      clearPreview();
    } else if (navigator.share){
      // compartir solo texto
      await navigator.share({ text });
      hint.textContent = dict.sharedOK;
    } else {
      // fallback: copiar texto y (si hay imagen) descargarla o sugerir subir
      await navigator.clipboard.writeText(text);
      hint.textContent = dict.copiedOK;
    }
  }catch(err){
    console.log('Compartir manual cancelado/fallido', err);
  }
});

/* enlaces de botones */
document.getElementById('btnGoogle').href = GOOGLE_MAPS_SHORT;
document.getElementById('btnPrivate').href = "https://tally.so/r/w2Qla9";

/* inicial preview vac√≠o */
clearPreview();

</script>
</body>
</html>

